<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Liquidsoap</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!-- Extra details for Live View on GitHub Pages -->
    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.liquidsoap.info/" />
    <!--  Social tags      -->
    <meta name="keywords" content="radio, audio, video, streaming, icecast, shoutcast">
    <meta name="description" content="Swiss-army knife for multimedia streaming">
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Liquidsoap Streaming Language">
    <meta itemprop="description" content="Swiss-army knife for multimedia streaming">
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@LiquidsoapMedia">
    <meta name="twitter:title" content="Liquidsoap Streaming Language">
    <meta name="twitter:description" content="Swiss-army knife for multimedia streaming">
    <meta name="twitter:creator" content="@LiquidsoapMedia">
    <meta name="twitter:image" content="https://www.liquidsoap.info//assets/img/bottle_invert.png">
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="/assets/css/custom.css" rel="stylesheet" />
    <link href="/assets/css/material-kit.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <!-- Documentation extras -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="/assets/demo/docs.min.css">
    <style>
    .navbar-absolute-logo {
      padding-left: 45px;
    }

    .navbar-absolute-logo img {
      position: absolute;
      left: 15px;
      margin-top: -6px;
    }

    body {
      background: white;
    }

    p {
        font-size: 16px;
        text-align: justify;
    }
    </style>
    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  </head>

  <body class="bd-docs" data-spy="scroll" data-target=".bd-sidenav-active">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <header class="navbar navbar-expand navbar-dark bg-primary flex-column flex-md-row bd-navbar">
      <a class="navbar-brand mr-0 mr-md-2 navbar-absolute-logo" href="/doc-2.1.4">
        <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 600 600" focusable="false" style="width: 25px; height: 25px;">
          <title>Liquidsoap</title>
          <style type="text/css">
.st0{fill:#FFFFFF;}
          </style>
          <g>
          <path class="st0" d="M102.4,593.8c-0.7-2.8-3.4-2.5-5.3-3.3c-24.6-10.2-37.2-28.7-37.2-55.6c-0.1-72.1,0-144.2,0-216.3
          c0-52.3,0-104.6,0-156.9c0-37.6,23.1-60.9,60.6-61.1c12-0.1,23.9-0.2,35.9,0c15.7,0.3,26.7,10.1,26.3,23
          c-0.4,12.5-11.1,21.5-26.3,21.8c-12,0.2-23.9-0.1-35.9,0.1c-11.8,0.1-15.6,3.7-15.6,15.3c-0.1,124.4,0,248.8-0.1,373.2
          c0,10.3,4.5,15.1,14.8,15.1c69.1-0.1,138.2,0,207.3-0.1c12.3,0,15.5-3.7,15.5-17.7c0-74.7,0-149.4,0-224.2c0-47.8,0-95.6,0-143.5
          c0-15.2-3-18.1-18.4-18.2c-10.8,0-21.7,0.1-32.5,0c-16-0.2-26.7-9.4-26.6-22.5c0.1-13,10.9-22.1,26.9-22.3
          c13.4-0.2,26.9-0.3,40.3,0.1c30.8,1,54.9,24.5,55,55.2c0.3,127.4,0.3,254.8,0.1,382.2c0,25.5-15.8,45.7-40.2,53.3
          c-1.7,0.5-3.8,0-4.5,2.4C262.3,593.8,182.4,593.8,102.4,593.8z"/>
          <path class="st0" d="M537.4,212.6c-16.8,23-56.5,16.5-68.6-9.5c-8-17.2-12.4-32.7-12-54.5c4.6,4.1,8.3,7.5,12.1,10.7
          c10.3,8.6,21,14,35.5,11.8c12.5-1.9,21.5,6,28.2,16.3c2,3,1.3,7.3,4.8,9.5C537.4,202.2,537.4,207.4,537.4,212.6z"/>
          <path class="st0" d="M200.6,230.4c0-55.3,0-110.5,0-165.8c0-40.7,22.3-62.7,63.2-62.7c50.4,0,100.8,0,151.3,0
          c36.1,0,59.1,21.9,60.4,57.7c0.5,13.1,0.4,26.1,0,39.2c-0.4,15.1-10.1,25.8-22.5,25.7c-12-0.1-21.6-10.1-22.3-24.8
          c-0.6-12.7-0.4-25.4-0.1-38.1c0.2-10.4-4.5-14.9-14.9-14.9c-51.5,0.1-103.1,0-154.6,0.1c-12.7,0-15.5,3.2-15.5,17.5
          c0,105.3,0,210.6,0,316c0,7.8,0.1,15.7,0,23.5c-0.2,17.5-9.4,28.9-23,28.6c-13.5-0.3-21.9-10.9-21.9-28.3
          C200.6,346.2,200.6,288.3,200.6,230.4z"/>
          </g>
        </svg>
        Liquidsoap
      </a>
      <ul class="navbar-nav flex-row d-none d-md-flex">
        <li class="nav-item dropdown">
          <a data-versions="dev 2.1.4 2.2.5 2.3.0 2.3.1 2.3.2
2.3.3" data-version="2.1.4" class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="liq-version" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            2.1.4
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="liq-version" id="liq-versions">
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/savonet/liquidsoap" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false">
              <title>GitHub</title>
              <path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd" />
            </svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://twitter.com/liquidsoapmedia" target="_blank" rel="noopener" aria-label="Twitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false">
              <title>Twitter</title>
              <path d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92" fill="currentColor" />
            </svg>
          </a>
        </li>
      </ul>
      <div class="navbar-nav-scroll ml-md-auto ">
        <ul class="navbar-nav bd-navbar-nav flex-row">
          <!--
            <li class="nav-item">
            <a class="nav-link" href=""> <i class="material-icons">card_membership</i> PRO Services </a>
            </li>
            -->
          <li class="nav-item">
            <script async src="https://cse.google.com/cse.js?cx=24f50f6f088994c53"></script>
            <style>
.cse .gsc-control-cse, .gsc-control-cse {
  background-color: transparent;
  border: none;
  width: 300px;
}
            </style>
            <div class="gcse-search"></div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/savonet/liquidsoap/issues" target="_blank" rel="noopener"><i class="material-icons">star</i> Get Help</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/savonet/liquidsoap" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#9c27b0; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
      </a>
      <style>
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out
}

        @keyframes octocat-wave {
          0%,
          100% {
            transform: rotate(0)
          }
          20%,
          60% {
            transform: rotate(-25deg)
          }
          40%,
          80% {
            transform: rotate(10deg)
          }
        }

        @media (max-width:500px) {
          .github-corner:hover .octo-arm {
            animation: none
          }
          .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out
          }
        }
      </style>
    </header>
    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
          <nav class="collapse bd-links" id="bd-docs-nav">
            <div class="bd-toc-item active">
              <ul class="nav bd-sidenav">
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/doc-2.1.4/install.html">
                    Install
                  </a>
                </li>
                <li>
                  <a href="/doc-2.1.4/migrating.html">
                    Migrating from previous versions
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="#">
                    Starters
                  </a>
                </li>
                <li><a href="/doc-2.1.4/book.html">The book</a></li>
                <li>
                  <a href="/doc-2.1.4/presentations.html">Video Presentations</a>
                </li>
                <li>
                  <a href="/doc-2.1.4/help.html">How to find help</a>
                </li>
                <li>
                  <a href="/doc-2.1.4/faq.html">Frequently Asked Questions</a>
                </li>
                <li><a href="/doc-2.1.4/quick_start.html">Quickstart</a></li>
                <li>
                  <a href="/doc-2.1.4/complete_case.html">Complete case analysis</a>
                </li>
                <li>
                  <a href="/doc-2.1.4/cookbook.html">Cookbook</a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Reference
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.1.4/language.html">Script language</a></li>
                <li>
                  <a href="/doc-2.1.4/reference.html">Core API</a></li>
                <li>
                  <a href="/doc-2.1.4/reference-extras.html">Extra API</a></li>
                <li>
                  <a href="/doc-2.1.4/protocols.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.1.4/settings.html">Settings</a></li>
                <li>
                  <a href="/doc-2.1.4/ffmpeg.html">FFmpeg support</a></li>
                <li>
                  <a href="/doc-2.1.4/encoding_formats.html">Encoding formats</a></li>
                <li>
                  <a href="/doc-2.1.4/video.html">Videos streams</a></li>
                <li>
                  <a href="/doc-2.1.4/json.html">JSON import/export</a></li>
                <li>
                  <a href="/doc-2.1.4/ladspa.html">LADSPA plugins</a></li>
                <li>
                  <a href="/doc-2.1.4/playlist_parsers.html">Playlist parsers</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Core
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.1.4/sources.html">Sources</a></li>
                <li>
                  <a href="/doc-2.1.4/clocks.html">Clocks</a></li>
                <li>
                  <a href="/doc-2.1.4/requests.html">Requests</a></li>
                <li>
                  <a href="/doc-2.1.4/protocols-presentation.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.1.4/stream_content.html">Stream contents</a></li>
                <li>
                  <a href="/doc-2.1.4/script_loading.html">Script loading</a></li>
                <li><a href="/doc-2.1.4/phases.html">Execution phases</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Specific tutorials
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.1.4/blank.html">Blank detection</a></li>
                <li>
                  <a href="/doc-2.1.4/metadata.html">Customize metadata</a></li>
                <li>
                  <a href="/doc-2.1.4/seek.html">Seek and cue support</a></li>
                <li>
                  <a href="/doc-2.1.4/external_decoders.html">External decoders</a></li>
                <li>
                  <a href="/doc-2.1.4/external_streams.html">External streams</a></li>
                <li>
                  <a href="/doc-2.1.4/external_encoders.html">External encoders</a></li>
                <li>
                  <a href="/doc-2.1.4/hls_output.html">HLS output</a></li>
                <li>
                  <a href="/doc-2.1.4/http_input.html">HTTP input</a></li>
                <li>
                  <a href="/doc-2.1.4/harbor.html">Harbor input</a></li>
                <li>
                  <a href="/doc-2.1.4/harbor_http.html">Interaction with the Harbor</a></li>
                <li>
                  <a href="/doc-2.1.4/server.html">Interaction with the server</a></li>
                <li>
                  <a href="/doc-2.1.4/icy_metadata.html">ICY metadata update</a></li>
                <li>
                  <a href="/doc-2.1.4/replay_gain.html">Normalization and replay gain</a></li>
                <li>
                  <a href="/doc-2.1.4/request_sources.html">Requests-based sources</a></li>
                <li>
                  <a href="/doc-2.1.4/shoutcast.html">Shoutcast output</a></li>
                <li>
                  <a href="/doc-2.1.4/dynamic_sources.html">Dynamic source creation</a></li>
                <li>
                  <a href="/doc-2.1.4/crossfade.html">Crossfading</a></li>
                <li>
                  <a href="/doc-2.1.4/in_production.html">Using in production</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    User scripts
                  </a>
                </li>
                <li>
                  <a href="/doc-2.1.4/beets.html">Beets</a></li>
                <li>
                  <a href="/doc-2.1.4/geekradio.html">Geekradio</a></li>
                <li>
                  <a href="/doc-2.1.4/radiopi.html">RadioPi</a></li>
                <li>
                  <a href="/doc-2.1.4/dolebrai.html">Dolebraï</a></li>
                <li>
                  <a href="/doc-2.1.4/frequence3.html">Frequence3</a></li>
                <li>
                  <a href="/doc-2.1.4/video-static.html">Video with a single static image</a></li>
                <li>
                  <a href="/doc-2.1.4/split-cue.html">Split a CUE sheet</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    Behind the curtains
                  </a>
                </li>
                <li>
                  <a href="/doc-2.1.4/publications.html">Some presentations and publications</a></li>
                <li>
                  <a href="https://github.com/savonet">OCaml libraries</a></li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/legacy">
                    Legacy website
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <!--
          <div class="d-none d-xl-block col-xl-2 bd-toc">
          <ul class="section-nav">
          <li class="toc-entry toc-h2">
          <a href="#quick-start">Quick start</a>
          <ul>
          <li class="toc-entry toc-h3">
          <a href="#css">CSS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#js">JS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#fonts-and-icons">Fonts and Icons</a>
          </li>
          </ul>
          </li>
          <li class="toc-entry toc-h2">
          <a href="#starter-template">Starter template</a>
          </li>
          </ul>
          </div>
        -->
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
          <p>This part is pretty open. We describe below a few advanced
features of liquidsoap, including video and midi. We provide some
examples or simply propose things to do, to give you an idea of what’s
in the near future of liquidsoap and hopefully draw you into
contributing to shaping that future, if only through discussions.</p>
<h1 id="visualization"><a href="#visualization"
class="anchor">Visualization</a></h1>
<p>A liquidsoap script is like any other program: you can in principle
predict what it does, but there’s always a point where you miss
something. In such cases, you need to debug it: control all the relevant
parameters until you spot what’s wrong.</p>
<p>In liquidsoap, the most important parameter is probably the
availability of a source. You’ll end up creating devices dealing with
various sources going on and off. To test them you can create sources
whose availability is controlled by you, and you should also be able to
monitor their availability.</p>
<p>As an exercise, you can try to write a simple logging function that
periodically displays <code>source.is_ready(s)</code> for some source
<code>s</code>. The <code>mix</code> operator can be useful too: it is a
mixing table for liquidsoap, allowing you to monitor and cancel the
availability of its inputs; the best way to use it is through
liGuidsoap.</p>
<h2 id="audio-volume"><a href="#audio-volume" class="anchor">Audio
volume</a></h2>
<p>You can visualize the audio volume on screen using
<code>visu.volume</code>:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">d</span> = <span class="fl">1.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">t</span> = <span class="st">&quot;lin&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">fade.in</span>(<span class="va">duration</span>=d,<span class="va">type</span>=t,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fade.out</span>(<span class="va">duration</span>=d,<span class="va">type</span>=t,<span class="dt">sine</span>(<span class="va">duration</span>=<span class="fl">3.</span>*d)))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dt">output.ao</span>(<span class="dt">visu.volume</span>(s))</span></code></pre></div>
<h1 id="video-streams"><a href="#video-streams" class="anchor">Video
streams</a></h1>
<p>Video may be used very simply in liquidsoap: common operators such as
<code>single</code> and <code>playlist</code> will attempt to decode
their files as video if their content type is appropriate, which is
dictated by the output operator. For example you can do
<code>output.sdl(single("video.ogg"))</code> to display the video part
of an audio+video stream; to hear the audio part, insert your favorite
audio output operator together with <code>drop_audio</code> and
<code>drop_video</code> at the right places (most outputs do not
silently drop irrelevant data).</p>
<h2 id="slideshow"><a href="#slideshow"
class="anchor">Slideshow</a></h2>
<p>The following script displays a slideshow of images, while playing a
playlist of audio files. Pass it the images playlist/directory as the
first argument on the command line (after <code>--</code>) and
(optionally) the audio playlist/directory as the second argument.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> images</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">video.fade.in</span>(<span class="va">duration</span>=<span class="fl">1.</span>,<span class="dt">video.fade.out</span>(<span class="va">duration</span>=<span class="fl">1.</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">video.add_text</span>(<span class="va">metadata</span>=<span class="st">&quot;filename&quot;</span>,<span class="st">&quot;&lt;no filename&gt;&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                   <span class="va">size</span>=<span class="dv">12</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                   <span class="dt">playlist</span>(<span class="va">prefix</span>=<span class="st">&quot;annotate:duration=3:&quot;</span>,<span class="dt">argv</span>(<span class="dv">1</span>)))))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sound</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">playlist</span>(<span class="dt">argv</span>(<span class="dv">2</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="dt">output.ao</span>(<span class="va">fallible</span>=<span class="dv">true</span>,sound)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="dt">clock</span>(<span class="va">id</span>=<span class="st">&quot;video&quot;</span>, <span class="dt">output.sdl</span>(<span class="va">fallible</span>=<span class="dv">true</span>,images))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># You can also combine the two in a Theora file.</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Play the result in VLC rather than mplayer (or even liquidsoap)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># as it is a sequentialized ogg stream.</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># output.file(%ogg(%vorbis,%theora),&quot;slideshow.ogg&quot;,</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   mksafe(mux_video(video=images,sound)))</span></span></code></pre></div>
<p>If you experience transparency problems… it’s a known bug (see
notably <a href="http://savonet.rastageeks.org/ticket/393">#393</a>).
You may also experience segfaults… it does not seem to happen with a
selected list avoiding too large sizes or too exotic formats.</p>
<h2 id="audio-volume-1"><a href="#audio-volume-1" class="anchor">Audio
volume</a></h2>
<p>You can render the audio volume visualization as a video stream, that
you can then process as any other video stream:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">d</span> = <span class="fl">1.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="va">t</span> = <span class="st">&quot;lin&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">fade.in</span>(<span class="va">duration</span>=d,<span class="va">type</span>=t,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fade.out</span>(<span class="va">duration</span>=d,<span class="va">type</span>=t,<span class="dt">sine</span>(<span class="va">duration</span>=<span class="fl">3.</span>*d)))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="dt">output.sdl</span>(<span class="dt">drop_audio</span>(<span class="dt">video.volume</span>(s)))</span></code></pre></div>
<h2 id="static-image-over-audio-track"><a
href="#static-image-over-audio-track" class="anchor">Static image over
audio track</a></h2>
<p>TODO: the youtube encoder</p>
<h2 id="transitions"><a href="#transitions"
class="anchor">Transitions</a></h2>
<p>Playing a video file <code>video.ogv</code> is simply achieved by</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">single</span>(<span class="st">&quot;video.ogv&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="dt">output.sdl</span>(s)</span></code></pre></div>
<p>There are many useful (or not) effects in Liquidsoap which can be
used to modify the video. These should be inserted between the first and
the second line of the script above. For example, the image can be
converted to sepia by adding</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">video.sepia</span>(s)</span></code></pre></div>
<p>Common operations include adding a logo (stored in a PPM image file
<code>image.ppm</code>):</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">video.add_image</span>(<span class="va">width</span>=<span class="dv">30</span>, <span class="va">height</span>=<span class="dv">30</span>, <span class="va">x</span>=<span class="dv">10</span>, <span class="va">y</span>=<span class="dv">10</span>, <span class="va">file</span>=<span class="st">&quot;image.ppm&quot;</span>, s)</span></code></pre></div>
<p>and displaying a scrolling text:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">video.add_text</span>(<span class="st">&quot;Hello people!&quot;</span>, s)</span></code></pre></div>
<p>Try modifying the scrolling text example so that you can modify the
contents of the text over the telnet interface.</p>
<p>Very similarly to audio transitions (fade in, fade out, etc.) there
are some video transitions implemented. For example fading in the video
is simply done using</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">video.fade.in</span>(s)</span></code></pre></div>
<p>The kind of transition that should be used is controlled by the
<code>transition</code> parameter of <code>video.fade.in</code>. Try
<code>disc</code> for example, as well as the others that you can find
in the documentation.</p>
<p>Of course, the <code>add</code> operator of liquidsoap also works on
video streams. So, in order to add a rotating image on a video you could
use</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">add</span>([s,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>         <span class="dt">video.rotate</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>           <span class="dt">video.add_image</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>             <span class="va">width</span>=<span class="dv">50</span>, <span class="va">height</span>=<span class="dv">50</span>, <span class="va">x</span>=<span class="dv">150</span>, <span class="va">y</span>=<span class="dv">150</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>             <span class="va">file</span>=<span class="st">&quot;image.ppm&quot;</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>             <span class="dt">blank</span>()))])</span></code></pre></div>
<h2 id="overloaded-demo"><a href="#overloaded-demo"
class="anchor">Overloaded demo</a></h2>
<div class="sourceCode" id="cb10"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="va">file</span> = <span class="dt">single</span>(<span class="st">&quot;bus.ogg&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="va">istring</span> = interactive.string</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="va">v</span> = <span class="dt">add</span>([file,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>         <span class="co"># video.text(&quot;Hello world...&quot;),</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># video.text(&quot;Mip mip!&quot;,color=0xff0000,y=-1,speed=300),</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         <span class="dt">video.text</span>(<span class="dt">istring</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;&quot;</span>),<span class="va">color</span>=<span class="bn">0xff0000</span>,<span class="va">font</span>=mono,<span class="va">size</span>=<span class="dv">30</span>,<span class="va">y</span>=<span class="dv">-01</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>         <span class="dt">video.text</span>(<span class="dt">istring</span>(<span class="st">&quot;b&quot;</span>,<span class="st">&quot;&quot;</span>),<span class="va">color</span>=<span class="bn">0xff0000</span>,<span class="va">font</span>=mono,<span class="va">size</span>=<span class="dv">30</span>,<span class="va">y</span>=<span class="dv">-31</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>         <span class="dt">video.text</span>(<span class="dt">istring</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;&quot;</span>),<span class="va">color</span>=<span class="bn">0xff0000</span>,<span class="va">font</span>=mono,<span class="va">size</span>=<span class="dv">30</span>,<span class="va">y</span>=<span class="dv">-61</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="dt">output.alsa</span>(<span class="dt">drop_video</span>(file))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># output.file.theora(&quot;out.ogv&quot;,</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="dt">output.sdl</span>(<span class="dt">add</span>([<span class="dt">video.fade.in</span>(<span class="dt">video.fade.in</span>(<span class="va">transition</span>=<span class="st">&quot;disc&quot;</span>,v)),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                <span class="co"># video.rotate(video.scale(coef=0.3,offset_x=20,offset_y=20,v)),</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>               <span class="dt">video.image</span>(<span class="st">&quot;chameau.pnm&quot;</span>,<span class="va">width</span>=<span class="dv">50</span>,<span class="va">height</span>=<span class="dv">50</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                           <span class="va">x</span>=<span class="dv">-10</span>,<span class="va">y</span>=<span class="dv">10</span>,<span class="va">alpha</span>=<span class="bn">0xffffff</span>),</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>]))</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="va">text</span> = <span class="kw">fun</span> (v,s) -&gt; <span class="dt">ignore</span>(<span class="dt">server.execute</span>(&#39;var.set <span class="co">#{v} = &quot;#{s}&quot;&#39;))</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="dt">pingouin</span>()</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">text</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;(o_ &quot;</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">text</span>(<span class="st">&quot;b&quot;</span>,<span class="st">&quot;//\\ &quot;</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="dt">text</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;v_/_&quot;</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="dt">pan</span>()</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="dt">text</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;(X_ &quot;</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="dt">server.register</span>(<span class="st">&quot;pingouin&quot;</span>, <span class="kw">fun</span> (_) -&gt; <span class="kw">begin</span> <span class="dt">pingouin</span>() <span class="st">&quot;Oui seigneur...&quot;</span> <span class="kw">end</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="dt">server.register</span>(<span class="st">&quot;pan&quot;</span>, <span class="kw">fun</span> (_) -&gt; <span class="kw">begin</span> <span class="dt">pan</span>() <span class="st">&quot;Zog zog!&quot;</span> <span class="kw">end</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="dt">server.register</span>(<span class="st">&quot;anim&quot;</span>, <span class="kw">fun</span> (s) -&gt; <span class="kw">begin</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="va">s</span> = <span class="kw">if</span> <span class="va">s</span>==<span class="st">&quot;t&quot;</span> <span class="kw">then</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">pan</span>()</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;f&quot;</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">pingouin</span>()</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;t&quot;</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  <span class="dt">add_timeout</span>(<span class="fl">1.</span>,{ <span class="dt">ignore</span>(<span class="dt">server.execute</span>(<span class="st">&quot;anim #{s}&quot;</span>)) (<span class="fl">-1.</span>) })</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Done.&quot;</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span>)</span></code></pre></div>
<h1 id="manipulating-midi-data"><a href="#manipulating-midi-data"
class="anchor">Manipulating MIDI data</a></h1>
<h2 id="playing-with-the-keyboard"><a href="#playing-with-the-keyboard"
class="anchor">Playing with the keyboard</a></h2>
<p>MIDI is a format for describing streams of notes, scores, etc.
Liquidsoap has a basic support for such streams.</p>
<p>In order to generate a MIDI stream, the
<code>input.keyboard.sdl</code> operator can be used. It will convert
typing onto the keyboard of your operator into notes. In order to be
able to hear the notes of a stream, you have to <em>synthesize</em>
them, which means to convert them to wave sound. Various operators can
be used for this, each corresponding to a different instrument. For
example, a synthesizer with sawtooth waves is provided by the operator
<code>synth.saw</code>. A mini-keyboard synthesizer can thus be
programmed using the following script</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">input.keyboard.sdl</span>()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">synth.saw</span>(s)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="dt">out</span>(s)</span></code></pre></div>
<p>You can also test <code>synth.sine</code> or
<code>synth.square</code> for other kinds of simple sounds.</p>
<p>In order to check the MIDI data contained in streams, the
<code>midimeter</code> operator is very convenient: it prints on the
standard output the notes currently being played.</p>
<h2 id="playing-midi-files"><a href="#playing-midi-files"
class="anchor">Playing MIDI files</a></h2>
<p>Liquidsoap comes with built-in support for MIDI files: when such a
file is played it is detected as such and decoded as a MIDI stream.
Usually, MIDI files contain multiple channels of notes (typically one
for each instrument). In order to use the sawtooth synthesizer on all
channels, the <code>synth.all.saw</code> operator should be used (with
the <code>synth.saw</code> operator, only the first channel will be
synthesized).</p>
<p>So, a MIDI file named <code>file.mid</code> can be played using the
following script</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">single</span>(<span class="st">&quot;file.mid&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">midi.remove</span>([<span class="dv">9</span>],s)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">mux_audio</span>(<span class="va">audio</span>=<span class="dt">blank</span>(),s)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">synth.all.saw</span>(s)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">drop_midi</span>(s)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="dt">out</span>(s)</span></code></pre></div>
<p>The second line removes all the notes from the channel 9 which is
usually used for drums (and would thus sound bad with our basic
synthesizer). The third line adds an audio channel to the stream
<code>s</code>, in which the sound will be synthesized.</p>
<h2 id="playing-chords"><a href="#playing-chords" class="anchor">Playing
chords</a></h2>
<p>The implementation of MIDI-related operators in Liquidsoap is still
in early stage and their implementation gives us the possibility to
simply test new ideas… we would be glad hear yours too!</p>
<p>For example, we thought it would be nice to be able to play chords in
Liquidsoap. This is actually pretty simple using metadata. First,
describe your sequence of chords in a file named <code>chords.txt</code>
with the following contents:</p>
<pre><code>1 &quot;chord&quot; &quot;C&quot;
2 &quot;chord&quot; &quot;Am&quot;
3 &quot;chord&quot; &quot;F&quot;
4 &quot;chord&quot; &quot;G&quot;</code></pre>
<p>This file just contains a list of metadata: on each line, the first
number indicate when (in seconds) the metadata should occur, the string
in second indicates the name of the metadata (<code>chord</code> here)
and the string in third position indicates the value of the metadata
(the chord to be played here). This file format for metadata is
supported natively by Liquidsoap. Now, the metadata containing the chord
names can be converted to MIDI notes by using the <code>chord</code>
operator. The sequence of chords above can thus be heard using the
following script:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">single</span>(<span class="st">&quot;chord.txt&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">midi.chord</span>(s)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">mux_audio</span>(<span class="va">audio</span>=<span class="dt">blank</span>(),s)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">synth.saw</span>(s)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">drop_midi</span>(s)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="dt">out</span>(s)</span></code></pre></div>
<h1 id="open-problems"><a href="#open-problems" class="anchor">Open
problems</a></h1>
<p>If you feel like hacking seriously, here are some tasks from the
Savonet community.</p>
<h2 id="listener-sensitive-radio"><a href="#listener-sensitive-radio"
class="anchor">Listener-sensitive radio</a></h2>
<p>Write a script that checks whether an icecast mount point is being
listened to, and use it to switch a radio to some dummy source when
nobody is listening, and switch back to normal when listeners come back.
This can be useful to avoid using the hard drive when unnecessary – it
is noisy, calorific, and simply not so long-lived.</p>
<h2 id="liquidsoap-script-generator"><a
href="#liquidsoap-script-generator" class="anchor">Liquidsoap script
generator</a></h2>
<p>Write a script (even better, a web page) that generates a simple
liquidsoap script with a few options: input from playlist, live relay,
output to icecast and/or soundcard.</p>
<h2 id="re-usable-tools-for-radios"><a
href="#re-usable-tools-for-radios" class="anchor">Re-usable tools for
radios</a></h2>
<p>The open-source radio community needs re-usable tools that can be
interfaced with existing streamers: indexer, database generator,
scheduler, crossfading editor, etc.</p>
          <div id="footer"></div>
        </main>
      </div>
    </div>
    <!--   Core JS Files   -->

    <script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/assets/js/liq-jquery.js" type="text/javascript"></script>
  </body>

</html>
