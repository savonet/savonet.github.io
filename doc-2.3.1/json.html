<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Liquidsoap</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!-- Extra details for Live View on GitHub Pages -->
    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.liquidsoap.info/" />
    <!--  Social tags      -->
    <meta name="keywords" content="radio, audio, video, streaming, icecast, shoutcast">
    <meta name="description" content="Swiss-army knife for multimedia streaming">
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Liquidsoap Streaming Language">
    <meta itemprop="description" content="Swiss-army knife for multimedia streaming">
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@LiquidsoapMedia">
    <meta name="twitter:title" content="Liquidsoap Streaming Language">
    <meta name="twitter:description" content="Swiss-army knife for multimedia streaming">
    <meta name="twitter:creator" content="@LiquidsoapMedia">
    <meta name="twitter:image" content="https://www.liquidsoap.info//assets/img/bottle_invert.png">
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="/assets/css/custom.css" rel="stylesheet" />
    <link href="/assets/css/material-kit.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <!-- Documentation extras -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="/assets/demo/docs.min.css">
    <style>
    .navbar-absolute-logo {
      padding-left: 45px;
    }

    .navbar-absolute-logo img {
      position: absolute;
      left: 15px;
      margin-top: -6px;
    }

    body {
      background: white;
    }

    p {
        font-size: 16px;
        text-align: justify;
    }
    </style>
    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  </head>

  <body class="bd-docs" data-spy="scroll" data-target=".bd-sidenav-active">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <header class="navbar navbar-expand navbar-dark bg-primary flex-column flex-md-row bd-navbar">
      <a class="navbar-brand mr-0 mr-md-2 navbar-absolute-logo" href="/doc-2.3.1">
        <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 600 600" focusable="false" style="width: 25px; height: 25px;">
          <title>Liquidsoap</title>
          <style type="text/css">
.st0{fill:#FFFFFF;}
          </style>
          <g>
          <path class="st0" d="M102.4,593.8c-0.7-2.8-3.4-2.5-5.3-3.3c-24.6-10.2-37.2-28.7-37.2-55.6c-0.1-72.1,0-144.2,0-216.3
          c0-52.3,0-104.6,0-156.9c0-37.6,23.1-60.9,60.6-61.1c12-0.1,23.9-0.2,35.9,0c15.7,0.3,26.7,10.1,26.3,23
          c-0.4,12.5-11.1,21.5-26.3,21.8c-12,0.2-23.9-0.1-35.9,0.1c-11.8,0.1-15.6,3.7-15.6,15.3c-0.1,124.4,0,248.8-0.1,373.2
          c0,10.3,4.5,15.1,14.8,15.1c69.1-0.1,138.2,0,207.3-0.1c12.3,0,15.5-3.7,15.5-17.7c0-74.7,0-149.4,0-224.2c0-47.8,0-95.6,0-143.5
          c0-15.2-3-18.1-18.4-18.2c-10.8,0-21.7,0.1-32.5,0c-16-0.2-26.7-9.4-26.6-22.5c0.1-13,10.9-22.1,26.9-22.3
          c13.4-0.2,26.9-0.3,40.3,0.1c30.8,1,54.9,24.5,55,55.2c0.3,127.4,0.3,254.8,0.1,382.2c0,25.5-15.8,45.7-40.2,53.3
          c-1.7,0.5-3.8,0-4.5,2.4C262.3,593.8,182.4,593.8,102.4,593.8z"/>
          <path class="st0" d="M537.4,212.6c-16.8,23-56.5,16.5-68.6-9.5c-8-17.2-12.4-32.7-12-54.5c4.6,4.1,8.3,7.5,12.1,10.7
          c10.3,8.6,21,14,35.5,11.8c12.5-1.9,21.5,6,28.2,16.3c2,3,1.3,7.3,4.8,9.5C537.4,202.2,537.4,207.4,537.4,212.6z"/>
          <path class="st0" d="M200.6,230.4c0-55.3,0-110.5,0-165.8c0-40.7,22.3-62.7,63.2-62.7c50.4,0,100.8,0,151.3,0
          c36.1,0,59.1,21.9,60.4,57.7c0.5,13.1,0.4,26.1,0,39.2c-0.4,15.1-10.1,25.8-22.5,25.7c-12-0.1-21.6-10.1-22.3-24.8
          c-0.6-12.7-0.4-25.4-0.1-38.1c0.2-10.4-4.5-14.9-14.9-14.9c-51.5,0.1-103.1,0-154.6,0.1c-12.7,0-15.5,3.2-15.5,17.5
          c0,105.3,0,210.6,0,316c0,7.8,0.1,15.7,0,23.5c-0.2,17.5-9.4,28.9-23,28.6c-13.5-0.3-21.9-10.9-21.9-28.3
          C200.6,346.2,200.6,288.3,200.6,230.4z"/>
          </g>
        </svg>
        Liquidsoap
      </a>
      <ul class="navbar-nav flex-row d-none d-md-flex">
        <li class="nav-item dropdown">
          <a data-versions="dev 2.1.4 2.2.5 2.3.0 2.3.1 2.3.2
2.3.3" data-version="2.3.1" class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="liq-version" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            2.3.1
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="liq-version" id="liq-versions">
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/savonet/liquidsoap" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false">
              <title>GitHub</title>
              <path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd" />
            </svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://twitter.com/liquidsoapmedia" target="_blank" rel="noopener" aria-label="Twitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false">
              <title>Twitter</title>
              <path d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92" fill="currentColor" />
            </svg>
          </a>
        </li>
      </ul>
      <div class="navbar-nav-scroll ml-md-auto ">
        <ul class="navbar-nav bd-navbar-nav flex-row">
          <!--
            <li class="nav-item">
            <a class="nav-link" href=""> <i class="material-icons">card_membership</i> PRO Services </a>
            </li>
            -->
          <li class="nav-item">
            <script async src="https://cse.google.com/cse.js?cx=24f50f6f088994c53"></script>
            <style>
.cse .gsc-control-cse, .gsc-control-cse {
  background-color: transparent;
  border: none;
  width: 300px;
}
            </style>
            <div class="gcse-search"></div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/savonet/liquidsoap/issues" target="_blank" rel="noopener"><i class="material-icons">star</i> Get Help</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/savonet/liquidsoap" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#9c27b0; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
      </a>
      <style>
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out
}

        @keyframes octocat-wave {
          0%,
          100% {
            transform: rotate(0)
          }
          20%,
          60% {
            transform: rotate(-25deg)
          }
          40%,
          80% {
            transform: rotate(10deg)
          }
        }

        @media (max-width:500px) {
          .github-corner:hover .octo-arm {
            animation: none
          }
          .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out
          }
        }
      </style>
    </header>
    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
          <nav class="collapse bd-links" id="bd-docs-nav">
            <div class="bd-toc-item active">
              <ul class="nav bd-sidenav">
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/doc-2.3.1/install.html">
                    Install
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.1/migrating.html">
                    Migrating from previous versions
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="#">
                    Starters
                  </a>
                </li>
                <li><a href="/doc-2.3.1/book.html">The book</a></li>
                <li>
                  <a href="/doc-2.3.1/presentations.html">Video Presentations</a>
                </li>
                <li>
                  <a href="/doc-2.3.1/help.html">How to find help</a>
                </li>
                <li>
                  <a href="/doc-2.3.1/faq.html">Frequently Asked Questions</a>
                </li>
                <li><a href="/doc-2.3.1/quick_start.html">Quickstart</a></li>
                <li>
                  <a href="/doc-2.3.1/complete_case.html">Complete case analysis</a>
                </li>
                <li>
                  <a href="/doc-2.3.1/cookbook.html">Cookbook</a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Reference
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.1/language.html">Script language</a></li>
                <li>
                  <a href="/doc-2.3.1/reference.html">Core API</a></li>
                <li>
                  <a href="/doc-2.3.1/reference-extras.html">Extra API</a></li>
                <li>
                  <a href="/doc-2.3.1/reference-deprecated.html">Deprecated API</a></li>
                <li>
                  <a href="/doc-2.3.1/multitrack.html">Multitrack</a></li>
                <li>
                  <a href="/doc-2.3.1/threads.html">Threads</a></li>
                <li>
                  <a href="/doc-2.3.1/protocols.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.3.1/settings.html">Settings</a></li>
                <li>
                  <a href="/doc-2.3.1/ffmpeg.html">FFmpeg support</a></li>
                <li>
                  <a href="/doc-2.3.1/encoding_formats.html">Encoding formats</a></li>
                <li>
                  <a href="/doc-2.3.1/video.html">Videos streams</a></li>
                <li>
                  <a href="/doc-2.3.1/memory.html">Memory management</a></li>
                <li>
                  <a href="/doc-2.3.1/json.html">JSON import/export</a></li>
                <li>
                  <a href="/doc-2.3.1/xml.html">XML import/export</a></li>
                <li>
                  <a href="/doc-2.3.1/yaml.html">YAML import/export</a></li>
                <li>
                  <a href="/doc-2.3.1/ladspa.html">LADSPA plugins</a></li>
                <li>
                  <a href="/doc-2.3.1/playlist_parsers.html">Playlist parsers</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Core
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.1/sources.html">Sources</a></li>
                <li>
                  <a href="/doc-2.3.1/clocks.html">Clocks</a></li>
                <li>
                  <a href="/doc-2.3.1/requests.html">Requests</a></li>
                <li>
                  <a href="/doc-2.3.1/protocols-presentation.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.3.1/stream_content.html">Stream contents</a></li>
                <li>
                  <a href="/doc-2.3.1/strings_encoding.html">Strings encoding</a></li>
                <li>
                  <a href="/doc-2.3.1/script_loading.html">Script loading</a></li>
                <li><a href="/doc-2.3.1/phases.html">Execution phases</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Specific tutorials
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.1/harbor_http.html">Using the HTTP server</a></li>
                <li>
                  <a href="/doc-2.3.1/blank.html">Blank detection</a></li>
                <li>
                  <a href="/doc-2.3.1/metadata.html">Customize metadata</a></li>
                <li>
                  <a href="/doc-2.3.1/seek.html">Seek and cue support</a></li>
                <li>
                  <a href="/doc-2.3.1/external_decoders.html">External decoders</a></li>
                <li>
                  <a href="/doc-2.3.1/external_streams.html">External streams</a></li>
                <li>
                  <a href="/doc-2.3.1/external_encoders.html">External encoders</a></li>
                <li>
                  <a href="/doc-2.3.1/hls_output.html">HLS output</a></li>
                <li>
                  <a href="/doc-2.3.1/http_input.html">HTTP input</a></li>
                <li>
                  <a href="/doc-2.3.1/harbor.html">Harbor input</a></li>
                <li>
                  <a href="/doc-2.3.1/stereotool.html">Stereotool</a></li>
                <li>
                  <a href="/doc-2.3.1/server.html">Using the telnet server</a></li>
                <li>
                  <a href="/doc-2.3.1/icy_metadata.html">ICY metadata update</a></li>
                <li>
                  <a href="/doc-2.3.1/replay_gain.html">Normalization and replay gain</a></li>
                <li>
                  <a href="/doc-2.3.1/request_sources.html">Requests-based sources</a></li>
                <li>
                  <a href="/doc-2.3.1/shoutcast.html">Shoutcast output</a></li>
                <li>
                  <a href="/doc-2.3.1/dynamic_sources.html">Dynamic source creation</a></li>
                <li>
                  <a href="/doc-2.3.1/crossfade.html">Crossfading</a></li>
                <li>
                  <a href="/doc-2.3.1/in_production.html">Using in production</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    User scripts
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.1/beets.html">Beets</a></li>
                <li>
                  <a href="/doc-2.3.1/geekradio.html">Geekradio</a></li>
                <li>
                  <a href="/doc-2.3.1/radiopi.html">RadioPi</a></li>
                <li>
                  <a href="/doc-2.3.1/dolebrai.html">Dolebraï</a></li>
                <li>
                  <a href="/doc-2.3.1/frequence3.html">Frequence3</a></li>
                <li>
                  <a href="/doc-2.3.1/video-static.html">Video with a single static image</a></li>
                <li>
                  <a href="/doc-2.3.1/split-cue.html">Split a CUE sheet</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    Behind the curtains
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.1/publications.html">Some presentations and publications</a></li>
                <li>
                  <a href="https://github.com/savonet">OCaml libraries</a></li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/legacy">
                    Legacy website
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <!--
          <div class="d-none d-xl-block col-xl-2 bd-toc">
          <ul class="section-nav">
          <li class="toc-entry toc-h2">
          <a href="#quick-start">Quick start</a>
          <ul>
          <li class="toc-entry toc-h3">
          <a href="#css">CSS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#js">JS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#fonts-and-icons">Fonts and Icons</a>
          </li>
          </ul>
          </li>
          <li class="toc-entry toc-h2">
          <a href="#starter-template">Starter template</a>
          </li>
          </ul>
          </div>
        -->
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
          <h2 id="importing-json-values"><a
href="#importing-json-values" class="anchor">Importing JSON
values</a></h2>
<p><em>Note:</em> If you are reading this page for the first time, you
might want to skip directly to the explicit type annotation below as
this is the recommended way of parsing JSON data. The content before
that is here to explain the inner workings of JSON parsing in
<code>liquidsoap</code>.</p>
<p>Liquidsoap supports importing JSON values through a special
<code>let</code> syntax. Using this syntax makes it relatively natural
to parse JSON data in your script while keeping type-safety at runtime.
Here’s an example:</p>
<div class="sourceCode" id="cb1" data-include="json1.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> json.parse <span class="va">v</span> = &#39;{<span class="st">&quot;foo&quot;</span>: <span class="st">&quot;abc&quot;</span>}&#39;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="st">&quot;We parsed a JSON object and got value &quot;</span> ^ v.foo ^ <span class="st">&quot; for attribute foo!&quot;</span>)</span></code></pre></div>
<p>This prints:</p>
<pre><code>We parsed a JSON object and got value abc for attribute foo!</code></pre>
<p>What happened here is that liquidsoap kept track of the fact that
<code>v</code> was called with <code>v.foo</code> and that the result of
that was a string. Then, at runtime, it checks the parsed JSON value
against this type and raises an issue if that did not match. For
instance, the following script:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> json.parse <span class="va">v</span> = &#39;{<span class="st">&quot;foo&quot;</span>: <span class="dv">123</span>}&#39;</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="st">&quot;We parsed a JSON object and got value &quot;</span> ^ v.foo ^ <span class="st">&quot; for attribute foo!&quot;</span>)</span></code></pre></div>
<p>raises the following exception:</p>
<pre><code>Error 14: Uncaught runtime error:
type: json,
message: &quot;Parsing error: json value cannot be parsed as type {foo: string, _}&quot;</code></pre>
<p>Of course, this all seems pretty trivial presented like that but,
let’s switch to reading a file instead:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> json.parse <span class="va">v</span> = <span class="dt">file.contents</span>(<span class="st">&quot;/path/to/file.json&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="st">&quot;We parsed a JSON object and got value &quot;</span> ^ v.foo ^ <span class="st">&quot; for attribute foo!&quot;</span>)</span></code></pre></div>
<p>Now, this is getting somewhere! Let’s push it further and parse a
whole <code>package.json</code> from a typical <code>npm</code>
package:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Content of package.json is:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># {</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  &quot;name&quot;: &quot;my_package&quot;,</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  &quot;version&quot;: &quot;1.0.0&quot;,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  &quot;scripts&quot;: {</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  },</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  ...</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> json.parse <span class="va">package</span> = <span class="dt">file.contents</span>(<span class="st">&quot;/path/to/package.json&quot;</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="va">name</span> = package.name</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="va">version</span> = package.version</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="va">test</span> = package.scripts.test</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="st">&quot;This is package &quot;</span> ^  name ^ <span class="st">&quot;, version &quot;</span> ^ version ^ <span class="st">&quot; with test script: &quot;</span> ^ test)</span></code></pre></div>
<p>And we get:</p>
<pre><code>This is package my_package, version 1.0.0 with test script: echo &quot;Error: no test specified&quot; &amp;&amp; exit 1</code></pre>
<p>This can even be combined with <em>patterns</em>:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> json.parse {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  name,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  version,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="va">scripts</span> = {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    test</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>} = <span class="dt">file.contents</span>(<span class="st">&quot;/path/to/package.json&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="st">&quot;This is package &quot;</span> ^  name ^ <span class="st">&quot;, version &quot;</span> ^ version ^ <span class="st">&quot; with test script: &quot;</span> ^ test)</span></code></pre></div>
<p>Now, this is looking nice!</p>
<h2 id="explicit-type-annotation"><a href="#explicit-type-annotation"
class="anchor">Explicit type annotation</a></h2>
<p>Explicit type annotation are the recommended way to parse JSON
data.</p>
<p>Let’s try a slight variation of the previous script now:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> json.parse {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  name,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  version,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="va">scripts</span> = {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    test</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>} = <span class="dt">file.contents</span>(<span class="st">&quot;/path/to/package.json&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="st">&quot;This is package #{name}, version #{version} with test script: #{test}&quot;</span>)</span></code></pre></div>
<p>This returns:</p>
<pre><code>This is package null, version null with test script: null</code></pre>
<p>What? 🤔</p>
<p>This is because, in this script, we only use <code>name</code>,
<code>version</code>, etc.. through the interpolation syntax
<code>#{...}</code>. However, interpolated variables can be anything so
this does not leave enough information to the typing system to know what
type those variables should be and, in this case, we default to
<code>null</code>.</p>
<p>In order to avoid bad surprises like this, it is usually recommended
to add <strong>type annotations</strong> to your json parsing call to
explicitly state what kind of data you are expecting. Let’s add one
here:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="dt">json.parse</span> ({</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  name,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  version,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="va">scripts</span> = {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    test</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>} : {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  name: string,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  version: string,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  scripts: {</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    test: string</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>}) = <span class="dt">file.contents</span>(<span class="st">&quot;/path/to/package.json&quot;</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="st">&quot;This is package #{name}, version #{version} with test script: #{test}&quot;</span>)</span></code></pre></div>
<p>And we get:</p>
<pre><code>This is package my_package, version 1.0.0 with test script: echo &quot;Error: no test specified&quot; &amp;&amp; exit 1</code></pre>
<p>Back to normal!</p>
<h3 id="type-syntax"><a href="#type-syntax" class="anchor">Type
syntax</a></h3>
<p>The syntax for type annotation is as follows:</p>
<h4 id="ground-types"><a href="#ground-types" class="anchor">Ground
types</a></h4>
<p><code>string</code>, <code>int</code>, <code>float</code> are parsed
as, resp., a string, an integer or a floating point number. Note that if
your json value contains an integer such as <code>123</code>, parsing it
as a floating point number will succeed. Also, if an integer is too big
to be represented as an <code>int</code> internally, it will be parsed
as a floating point number.</p>
<h4 id="nullable-types"><a href="#nullable-types"
class="anchor">Nullable types</a></h4>
<p>All type annotation can be postfixed with a trailing <code>?</code>
to denote a <em>nullable</em> value. If a type is nullable, the json
parser will return <code>null</code> when it cannot parse the value as
the principal type. This is particularly useful when you are not sure of
all the types that you are parsing.</p>
<p>For instance, some <code>npm</code> packages do not have a
<code>scripts</code> entry or a <code>test</code> entry, so you would
parse them as:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="dt">json.parse</span> ({</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  name,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  version,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  scripts,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>} : {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  name: string,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  version: string,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  scripts: {</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    test: string?</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  }?</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>}) = <span class="dt">file.contents</span>(<span class="st">&quot;/path/to/package.json&quot;</span>)</span></code></pre></div>
<p>And, later, inspect the returned value to see if it is in fact
present. You can do it in several ways:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the value is defined:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="va">test</span> =</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="dt">null.defined</span>(scripts) <span class="kw">then</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">null.get</span>(scripts.test)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">null</span> ()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the ?? syntax:</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="va">test</span> = (scripts ?? { <span class="va">test</span> = <span class="dt">null</span>() }).test</span></code></pre></div>
<h4 id="tuple-types"><a href="#tuple-types" class="anchor">Tuple
types</a></h4>
<p>The type <code>(int * float * string)</code> tells liquidsoap to
parse a JSON array whose <em>first values</em> are of type:
<code>int</code>, <code>float</code> and <code>string</code>. If any
further values are present in the array, they will be ignored.</p>
<p>For arrays as well as any other structured types, the special
notation <code>_</code> can be used to denote any type. For instance,
<code>(_ * _ * float)</code> denotes an JSON array whose first 2
elements can be of any type and its third element is a floating point
number.</p>
<h4 id="lists"><a href="#lists" class="anchor">Lists</a></h4>
<p>The type <code>[int]</code> tells liquidsoap to parse a JSON array
where <em>all its values</em> are integers as a list of integers. If you
are not sure if all elements in the array are integers, you can always
use nullable integers: <code>[int?]</code></p>
<h4 id="objects"><a href="#objects" class="anchor">Objects</a></h4>
<p>The type <code>{foo: int}</code> tells liquidsoap to parse a JSON
object as a record with an attribute labelled <code>foo</code> whose
value is an integer. All other attributes are ignored.</p>
<p>Arbitrary object keys can be parsed using the following syntax:
<code>{"foo bar key" as foo_bar_key: int}</code>, which tells liquidsoap
to parse a JSON object as a record with an attribute labelled
<code>foo_bar_key</code> which maps to the attribute
<code>"foo bar key"</code> from the JSON object.</p>
<h4 id="associative-lists-as-objects"><a
href="#associative-lists-as-objects" class="anchor">Associative lists as
objects</a></h4>
<p>It can sometimes be useful to parse a JSON object as an associative
list, for instance if you do not know in advance all the possible keys
of an object. In this case, you can use the special type:
<code>[(string * int)] as json.object</code>. This tells liquidsoap to
parse the JSON object as a list of pairs <code>(string * int)</code>
where <code>string</code> represents the attribute label and
<code>int</code> represent the attribute value.</p>
<p>If you are not sure if all the object values are integers you can
always use nullable integers:
<code>[(string * int?)] as json.object</code></p>
<h3 id="parsing-errors"><a href="#parsing-errors" class="anchor">Parsing
errors</a></h3>
<p>When parsing fails, a <code>error.json</code> is raised which can be
caught at runtime:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">try</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>   <span class="kw">let</span> <span class="dt">json.parse</span> ({</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>      status,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>      <span class="va">data</span> = {</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        track</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    } : {</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      status: string,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>      data: {</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        track: string</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    }) = res</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do something on success here..</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">catch</span> err: [error.json] <span class="kw">do</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Do something on parse errors here..</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<h4 id="example"><a href="#example" class="anchor">Example</a></h4>
<p>Here’s a full example. Feel free to refer to
<code>tests/language/json.liq</code> in the source code for more of
them.</p>
<div class="sourceCode" id="cb16" data-include="json-ex.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="va">data</span> = &#39;{</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;foo&quot;</span>: <span class="fl">34.24</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;gni gno&quot;</span>: <span class="dv">true</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;nested&quot;</span>: {</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;tuple&quot;</span>: [<span class="dv">123</span>, <span class="fl">3.14</span>, <span class="dv">false</span>],</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;list&quot;</span>:  [<span class="fl">44.0</span>, <span class="dv">55</span>, <span class="fl">66.12</span>],</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;nullable_list&quot;</span>: [<span class="fl">12.33</span>, <span class="dv">23</span>, <span class="st">&quot;aabb&quot;</span>],</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;object_as_list&quot;</span>: {</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;foo&quot;</span>: <span class="dv">123</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;gni&quot;</span>: <span class="fl">456.0</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;gno&quot;</span>: <span class="fl">3.14</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;arbitrary object key ✨&quot;</span>: <span class="dv">true</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>   },</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;extra&quot;</span>: <span class="st">&quot;ignored&quot;</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>}&#39;</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="dt">json.parse</span> ( x : {</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  foo: float,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;gni gno&quot;</span> as gni_gno: bool,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  nested: {</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    tuple: (_ * float),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    list: [float],</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    nullable_list: [int?],</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    object_as_list: [(string * float)] as json.object,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;arbitrary object key ✨&quot;</span> as arbitrary_object_key: bool,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    not_present: bool?</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>}) = data</span></code></pre></div>
<p>It returns</p>
<pre><code>  - x : {
    foo = 34.24,
    gni_gno = true,
    nested = {
      tuple = (null, 3.14),
      list = [44., 55., 66.12],
      nullable_list = [null, 23, null],
      object_as_list = [(&quot;foo&quot;, 123.), (&quot;gni&quot;, 456.0), (&quot;gno&quot;, 3.14)],
      arbitrary_object_key = true,
      not_present = null
    }
  }</code></pre>
<h3 id="json5-extension"><a href="#json5-extension" class="anchor">JSON5
extension</a></h3>
<p>Liquidsoap supports the <a href="https://json5.org/">JSON5</a>
extension. Parsing of <code>json5</code> values is enabled with the
following argument:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> json.parse[<span class="va">json5</span>=<span class="dv">true</span>] <span class="va">x</span> = ...</span></code></pre></div>
<p>If a <code>json5</code> variable is in scope, you can also simply use
<code>let json.parse[json5] x = ...</code></p>
<h2 id="exporting-json-values"><a href="#exporting-json-values"
class="anchor">Exporting JSON values</a></h2>
<p>Exporting JSON values can be done using the
<code>json.stringify</code> function:</p>
<div class="sourceCode" id="cb19" data-include="json-stringify.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="va">r</span> = {<span class="va">artist</span>=<span class="st">&quot;Bla&quot;</span>, <span class="va">title</span>=<span class="st">&quot;Blo&quot;</span>}</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="dt">json.stringify</span>(r))</span></code></pre></div>
<p>Please note that not all values are exportable as JSON, for instance
function. In such cases the function will raise an
<code>error.json</code> exception.</p>
<h2 id="generic-json-objects"><a href="#generic-json-objects"
class="anchor">Generic JSON objects</a></h2>
<p>Generic <code>JSON</code> objects can be manipulated through the
<code>json()</code> operator. This operator returns an opaque json
variable with methods to <code>add</code> and <code>remove</code>
attributes:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="va">j</span> = <span class="dt">json</span>()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="dt">j.add</span>(<span class="st">&quot;foo&quot;</span>, <span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="dt">j.add</span>(<span class="st">&quot;bla&quot;</span>, <span class="st">&quot;bar&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="dt">j.add</span>(<span class="st">&quot;baz&quot;</span>, <span class="fl">3.14</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="dt">j.add</span>(<span class="st">&quot;key_with_methods&quot;</span>, <span class="st">&quot;value&quot;</span>.{<span class="va">method</span> = <span class="dv">123</span>})</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="dt">j.add</span>(<span class="st">&quot;record&quot;</span>, { <span class="va">a</span> = <span class="dv">1</span>, <span class="va">b</span> = <span class="st">&quot;ert&quot;</span>})</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="dt">j.remove</span>(<span class="st">&quot;foo&quot;</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">json.stringify</span>(j)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>- s: &#39;{ <span class="st">&quot;record&quot;</span>: { <span class="st">&quot;b&quot;</span>: <span class="st">&quot;ert&quot;</span>, <span class="st">&quot;a&quot;</span>: <span class="dv">1</span> }, <span class="st">&quot;key_with_methods&quot;</span>: <span class="st">&quot;value&quot;</span>, <span class="st">&quot;bla&quot;</span>: <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;baz&quot;</span>: <span class="fl">3.14</span> }&#39;</span></code></pre></div>
          <div id="footer"></div>
        </main>
      </div>
    </div>
    <!--   Core JS Files   -->

    <script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/assets/js/liq-jquery.js" type="text/javascript"></script>
  </body>

</html>
