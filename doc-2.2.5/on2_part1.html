<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Liquidsoap</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!-- Extra details for Live View on GitHub Pages -->
    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.liquidsoap.info/" />
    <!--  Social tags      -->
    <meta name="keywords" content="radio, audio, video, streaming, icecast, shoutcast">
    <meta name="description" content="Swiss-army knife for multimedia streaming">
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Liquidsoap Streaming Language">
    <meta itemprop="description" content="Swiss-army knife for multimedia streaming">
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@LiquidsoapMedia">
    <meta name="twitter:title" content="Liquidsoap Streaming Language">
    <meta name="twitter:description" content="Swiss-army knife for multimedia streaming">
    <meta name="twitter:creator" content="@LiquidsoapMedia">
    <meta name="twitter:image" content="https://www.liquidsoap.info//assets/img/bottle_invert.png">
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="/assets/css/custom.css" rel="stylesheet" />
    <link href="/assets/css/material-kit.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <!-- Documentation extras -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="/assets/demo/docs.min.css">
    <style>
    .navbar-absolute-logo {
      padding-left: 45px;
    }

    .navbar-absolute-logo img {
      position: absolute;
      left: 15px;
      margin-top: -6px;
    }

    body {
      background: white;
    }

    p {
        font-size: 16px;
        text-align: justify;
    }
    </style>
    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  </head>

  <body class="bd-docs" data-spy="scroll" data-target=".bd-sidenav-active">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <header class="navbar navbar-expand navbar-dark bg-primary flex-column flex-md-row bd-navbar">
      <a class="navbar-brand mr-0 mr-md-2 navbar-absolute-logo" href="/doc-2.2.5">
        <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 600 600" focusable="false" style="width: 25px; height: 25px;">
          <title>Liquidsoap</title>
          <style type="text/css">
.st0{fill:#FFFFFF;}
          </style>
          <g>
          <path class="st0" d="M102.4,593.8c-0.7-2.8-3.4-2.5-5.3-3.3c-24.6-10.2-37.2-28.7-37.2-55.6c-0.1-72.1,0-144.2,0-216.3
          c0-52.3,0-104.6,0-156.9c0-37.6,23.1-60.9,60.6-61.1c12-0.1,23.9-0.2,35.9,0c15.7,0.3,26.7,10.1,26.3,23
          c-0.4,12.5-11.1,21.5-26.3,21.8c-12,0.2-23.9-0.1-35.9,0.1c-11.8,0.1-15.6,3.7-15.6,15.3c-0.1,124.4,0,248.8-0.1,373.2
          c0,10.3,4.5,15.1,14.8,15.1c69.1-0.1,138.2,0,207.3-0.1c12.3,0,15.5-3.7,15.5-17.7c0-74.7,0-149.4,0-224.2c0-47.8,0-95.6,0-143.5
          c0-15.2-3-18.1-18.4-18.2c-10.8,0-21.7,0.1-32.5,0c-16-0.2-26.7-9.4-26.6-22.5c0.1-13,10.9-22.1,26.9-22.3
          c13.4-0.2,26.9-0.3,40.3,0.1c30.8,1,54.9,24.5,55,55.2c0.3,127.4,0.3,254.8,0.1,382.2c0,25.5-15.8,45.7-40.2,53.3
          c-1.7,0.5-3.8,0-4.5,2.4C262.3,593.8,182.4,593.8,102.4,593.8z"/>
          <path class="st0" d="M537.4,212.6c-16.8,23-56.5,16.5-68.6-9.5c-8-17.2-12.4-32.7-12-54.5c4.6,4.1,8.3,7.5,12.1,10.7
          c10.3,8.6,21,14,35.5,11.8c12.5-1.9,21.5,6,28.2,16.3c2,3,1.3,7.3,4.8,9.5C537.4,202.2,537.4,207.4,537.4,212.6z"/>
          <path class="st0" d="M200.6,230.4c0-55.3,0-110.5,0-165.8c0-40.7,22.3-62.7,63.2-62.7c50.4,0,100.8,0,151.3,0
          c36.1,0,59.1,21.9,60.4,57.7c0.5,13.1,0.4,26.1,0,39.2c-0.4,15.1-10.1,25.8-22.5,25.7c-12-0.1-21.6-10.1-22.3-24.8
          c-0.6-12.7-0.4-25.4-0.1-38.1c0.2-10.4-4.5-14.9-14.9-14.9c-51.5,0.1-103.1,0-154.6,0.1c-12.7,0-15.5,3.2-15.5,17.5
          c0,105.3,0,210.6,0,316c0,7.8,0.1,15.7,0,23.5c-0.2,17.5-9.4,28.9-23,28.6c-13.5-0.3-21.9-10.9-21.9-28.3
          C200.6,346.2,200.6,288.3,200.6,230.4z"/>
          </g>
        </svg>
        Liquidsoap
      </a>
      <ul class="navbar-nav flex-row d-none d-md-flex">
        <li class="nav-item dropdown">
          <a data-versions="dev 2.2.5 2.3.0 2.3.1 2.3.2 2.3.3 2.4.0
2.4.1
2.4.2" data-version="2.2.5" class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="liq-version" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            2.2.5
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="liq-version" id="liq-versions">
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/savonet/liquidsoap" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false">
              <title>GitHub</title>
              <path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd" />
            </svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://twitter.com/liquidsoapmedia" target="_blank" rel="noopener" aria-label="Twitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false">
              <title>Twitter</title>
              <path d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92" fill="currentColor" />
            </svg>
          </a>
        </li>
      </ul>
      <div class="navbar-nav-scroll ml-md-auto ">
        <ul class="navbar-nav bd-navbar-nav flex-row">
          <!--
            <li class="nav-item">
            <a class="nav-link" href=""> <i class="material-icons">card_membership</i> PRO Services </a>
            </li>
            -->
          <li class="nav-item">
            <script async src="https://cse.google.com/cse.js?cx=24f50f6f088994c53"></script>
            <style>
.cse .gsc-control-cse, .gsc-control-cse {
  background-color: transparent;
  border: none;
  width: 300px;
}
            </style>
            <div class="gcse-search"></div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/savonet/liquidsoap/issues" target="_blank" rel="noopener"><i class="material-icons">star</i> Get Help</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/savonet/liquidsoap" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#9c27b0; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
      </a>
      <style>
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out
}

        @keyframes octocat-wave {
          0%,
          100% {
            transform: rotate(0)
          }
          20%,
          60% {
            transform: rotate(-25deg)
          }
          40%,
          80% {
            transform: rotate(10deg)
          }
        }

        @media (max-width:500px) {
          .github-corner:hover .octo-arm {
            animation: none
          }
          .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out
          }
        }
      </style>
    </header>
    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
          <nav class="collapse bd-links" id="bd-docs-nav">
            <div class="bd-toc-item active">
              <ul class="nav bd-sidenav">
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/doc-2.2.5/install.html">
                    Install
                  </a>
                </li>
                <li>
                  <a href="/doc-2.2.5/migrating.html">
                    Migrating from previous versions
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="#">
                    Starters
                  </a>
                </li>
                <li><a href="/doc-2.2.5/book.html">The book</a></li>
                <li>
                  <a href="/doc-2.2.5/presentations.html">Video Presentations</a>
                </li>
                <li>
                  <a href="/doc-2.2.5/help.html">How to find help</a>
                </li>
                <li>
                  <a href="/doc-2.2.5/faq.html">Frequently Asked Questions</a>
                </li>
                <li><a href="/doc-2.2.5/quick_start.html">Quickstart</a></li>
                <li>
                  <a href="/doc-2.2.5/complete_case.html">Complete case analysis</a>
                </li>
                <li>
                  <a href="/doc-2.2.5/cookbook.html">Cookbook</a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Reference
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.2.5/language.html">Script language</a></li>
                <li>
                  <a href="/doc-2.2.5/reference.html">Core API</a></li>
                <li>
                  <a href="/doc-2.2.5/reference-extras.html">Extra API</a></li>
                <li>
                  <a href="/doc-2.2.5/reference-deprecated.html">Deprecated API</a></li>
                <li>
                  <a href="/doc-2.2.5/multitrack.html">Multitrack</a></li>
                <li>
                  <a href="/doc-2.2.5/protocols.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.2.5/settings.html">Settings</a></li>
                <li>
                  <a href="/doc-2.2.5/ffmpeg.html">FFmpeg support</a></li>
                <li>
                  <a href="/doc-2.2.5/encoding_formats.html">Encoding formats</a></li>
                <li>
                  <a href="/doc-2.2.5/video.html">Videos streams</a></li>
                <li>
                  <a href="/doc-2.2.5/memory.html">Memory management</a></li>
                <li>
                  <a href="/doc-2.2.5/json.html">JSON import/export</a></li>
                <li>
                  <a href="/doc-2.2.5/yaml.html">YAML import/export</a></li>
                <li>
                  <a href="/doc-2.2.5/ladspa.html">LADSPA plugins</a></li>
                <li>
                  <a href="/doc-2.2.5/playlist_parsers.html">Playlist parsers</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Core
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.2.5/sources.html">Sources</a></li>
                <li>
                  <a href="/doc-2.2.5/clocks.html">Clocks</a></li>
                <li>
                  <a href="/doc-2.2.5/requests.html">Requests</a></li>
                <li>
                  <a href="/doc-2.2.5/protocols-presentation.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.2.5/stream_content.html">Stream contents</a></li>
                <li>
                  <a href="/doc-2.2.5/strings_encoding.html">Strings encoding</a></li>
                <li>
                  <a href="/doc-2.2.5/script_loading.html">Script loading</a></li>
                <li><a href="/doc-2.2.5/phases.html">Execution phases</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Specific tutorials
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.2.5/harbor_http.html">Using the HTTP server</a></li>
                <li>
                  <a href="/doc-2.2.5/blank.html">Blank detection</a></li>
                <li>
                  <a href="/doc-2.2.5/metadata.html">Customize metadata</a></li>
                <li>
                  <a href="/doc-2.2.5/seek.html">Seek and cue support</a></li>
                <li>
                  <a href="/doc-2.2.5/external_decoders.html">External decoders</a></li>
                <li>
                  <a href="/doc-2.2.5/external_streams.html">External streams</a></li>
                <li>
                  <a href="/doc-2.2.5/external_encoders.html">External encoders</a></li>
                <li>
                  <a href="/doc-2.2.5/hls_output.html">HLS output</a></li>
                <li>
                  <a href="/doc-2.2.5/http_input.html">HTTP input</a></li>
                <li>
                  <a href="/doc-2.2.5/harbor.html">Harbor input</a></li>
                <li>
                  <a href="/doc-2.2.5/stereotool.html">Stereotool</a></li>
                <li>
                  <a href="/doc-2.2.5/server.html">Using the telnet server</a></li>
                <li>
                  <a href="/doc-2.2.5/icy_metadata.html">ICY metadata update</a></li>
                <li>
                  <a href="/doc-2.2.5/replay_gain.html">Normalization and replay gain</a></li>
                <li>
                  <a href="/doc-2.2.5/request_sources.html">Requests-based sources</a></li>
                <li>
                  <a href="/doc-2.2.5/shoutcast.html">Shoutcast output</a></li>
                <li>
                  <a href="/doc-2.2.5/dynamic_sources.html">Dynamic source creation</a></li>
                <li>
                  <a href="/doc-2.2.5/crossfade.html">Crossfading</a></li>
                <li>
                  <a href="/doc-2.2.5/in_production.html">Using in production</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    User scripts
                  </a>
                </li>
                <li>
                  <a href="/doc-2.2.5/beets.html">Beets</a></li>
                <li>
                  <a href="/doc-2.2.5/geekradio.html">Geekradio</a></li>
                <li>
                  <a href="/doc-2.2.5/radiopi.html">RadioPi</a></li>
                <li>
                  <a href="/doc-2.2.5/dolebrai.html">Dolebraï</a></li>
                <li>
                  <a href="/doc-2.2.5/frequence3.html">Frequence3</a></li>
                <li>
                  <a href="/doc-2.2.5/video-static.html">Video with a single static image</a></li>
                <li>
                  <a href="/doc-2.2.5/split-cue.html">Split a CUE sheet</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    Behind the curtains
                  </a>
                </li>
                <li>
                  <a href="/doc-2.2.5/publications.html">Some presentations and publications</a></li>
                <li>
                  <a href="https://github.com/savonet">OCaml libraries</a></li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/legacy">
                    Legacy website
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <!--
          <div class="d-none d-xl-block col-xl-2 bd-toc">
          <ul class="section-nav">
          <li class="toc-entry toc-h2">
          <a href="#quick-start">Quick start</a>
          <ul>
          <li class="toc-entry toc-h3">
          <a href="#css">CSS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#js">JS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#fonts-and-icons">Fonts and Icons</a>
          </li>
          </ul>
          </li>
          <li class="toc-entry toc-h2">
          <a href="#starter-template">Starter template</a>
          </li>
          </ul>
          </div>
        -->
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
          <p>This part starts from scratch. All you need is a working
install of liquidsoap. If you don’t have one already, we can help you;
but if you haven’t, check the <a href="download.html">corresponding
page</a>.</p>
<h1 id="run-liquidsoap-on-one-liners"><a
href="#run-liquidsoap-on-one-liners" class="anchor">Run liquidsoap on
one-liners</a></h1>
<p>A good way to test your install and get started is to execute very
small liquidsoap programs. Such ``one-liners’’ are also often useful to
accomplish simple tasks.</p>
<h2 id="play-a-synthesized-sound"><a href="#play-a-synthesized-sound"
class="anchor">Play a synthesized sound</a></h2>
<p>Simply execute the following command, and you should hear a 440Hz
sound on your soundcard:</p>
<pre><code>liquidsoap &#39;out(sine())&#39;</code></pre>
<p>Did it work? If so, try to modify it:</p>
<ul>
<li>Change the pitch. Hint: get the doc of <code>sine</code> using
<code>liquidsoap -h sine</code> or <a
href="reference.html">online</a>.</li>
<li>Use a different wave shape, or perhaps some white noise. Hint:
look-up the <a href="reference.html">API</a> in the
<code>Source / Input</code> section.</li>
</ul>
<h2 id="play-a-remote-stream-discover-fallibility"><a
href="#play-a-remote-stream-discover-fallibility" class="anchor">Play a
remote stream, discover fallibility</a></h2>
<p>Try to execute the liquidsoap expression:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">out</span>(<span class="dt">input.http</span>(<span class="st">&quot;http://ice.rosebud-media.de:8000/88vier&quot;</span>))</span></code></pre></div>
<p>You should now be listening to <a
href="http://piradio.de">Pi-Radio</a>, unless you have no network
connection, in which case the <code>input.http(...)</code> source
<em>fails</em>.</p>
<p>The output operator <code>out</code> is okay with failure: it simply
plays silence when the source fails, waiting for it to be ready again.
But some operators are stricter. If you try</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">output.ao</span>(<span class="dt">input.http</span>(<span class="st">&quot;http://ice.rosebud-media.de:8000/88vier&quot;</span>))</span></code></pre></div>
<p>the AO output (which uses libao to access your soundcard) warns you
that there might be a failure. To ignore this problem, pass
<code>fallible=true</code> to the output.</p>
<p>This might seem annoying but it can make sense if you have listeners
and you want to make sure that your stream is always up and running for
them.</p>
<h2 id="play-a-list-of-files"><a href="#play-a-list-of-files"
class="anchor">Play a list of files</a></h2>
<p>The <code>playlist</code> operator can be used to build a source that
plays a list of files. The resulting source will be fallible. You can
either pass a directory name, or a text file containing the list of
files. There are lots of possibilities here, but for now just look at
the <code>mode</code> parameter; we’ll learn more later.</p>
<h2 id="an-interactive-example"><a href="#an-interactive-example"
class="anchor">An interactive example</a></h2>
<p>Suppose we want to be able to request a particular file for playout
instead of the automatically chosen files of the playlist. This is
achieved by wrapping the playlist in a fallback choice with a request
queue:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dt">out</span>(<span class="dt">fallback</span>([<span class="dt">request.queue</span>(<span class="va">id</span>=<span class="st">&quot;q&quot;</span>),<span class="dt">playlist</span>(<span class="st">&quot;music&quot;</span>)]))</span></code></pre></div>
<p>If you run this example, you’ll hear your playlist, because the queue
is empty. The queue can be fed through <em>server commands</em>. Enable
the telnet server interface by passing <code>-t</code> on liquidsoap’s
command line, and connect to it using
<code>telnet localhost 1234</code>.</p>
<ul>
<li>Type <code>help</code>, find the command for pushing a request (by
its file name) in the queue, and try it.</li>
<li>Find the command for skipping the current track. If you skip a
playlist track after having pushed a request in the queue, you should
hear that request – unless the request failed to be prepared.</li>
<li>Find the command for listing the next requests in queue. They are
given by their request id (RID); the commands
<code>request.metadata</code> and <code>request.trace</code> give you
info from the RID.</li>
<li>Also notice commands for listing the next files to be played by the
playlist (depends on the playlist more), and reloading the
playlist.</li>
<li>Try setting <code>track_sensitive=false</code> for the fallback, see
what it does (better, guess what it does from the doc).</li>
</ul>
<h2 id="encode-a-file"><a href="#encode-a-file" class="anchor">Encode a
file</a></h2>
<p>You have learned how to build a few sources, synthesizing sound from
scratch, from a remote stream or from a list of files. Now, instead of
playing the stream directly to your soundcard, we’ll encode it and save
it to a local file:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dt">output.file</span>(<span class="ot">%vorbis</span>,<span class="st">&quot;test.ogg&quot;</span>,source)</span></code></pre></div>
<p>Here <code>source</code> is whatever you want, for example
<code>sine()</code>.</p>
<p>You can tweak the options of the encoding format, or change the
encoding format; the available options are listed <a
href="encoding_formats.html">here</a>. You can change the number of
channels (for example, using <code>%vorbis(mono)</code>) but this may
create problems with a playlist or remote stream, because conversions
are not implicit in liquidsoap; we’ll see later how to deal with
them.</p>
<h2 id="icecast-output"><a href="#icecast-output" class="anchor">Icecast
output</a></h2>
<p>You can now easily change the file example to send you stream to an
icecast server: simply use <code>output.icecast</code> instead of
<code>output.file</code>, passing a <code>mount</code> parameter instead
of a file name, and perhaps overriding the defaults for
<code>host</code> (<code>"127.0.0.1"</code>) and <code>password</code>
(<code>"hackme"</code>). You just created your first Internet radio
using liquidsoap!</p>
<p>If you have control over the icecast server (or over the network link
to that server) you can simulate a loss of connection. Notice that
liquidsoap only attempts once to reconnect, then fails and shuts down.
For another behavior that tolerates more persistent failures, set
<code>restart=true</code>.</p>
<h1 id="using-liquidsoap-in-production"><a
href="#using-liquidsoap-in-production" class="anchor">Using liquidsoap
in production</a></h1>
<p>One-liners are good for one-shot uses, but not the most convenient
for more complex liquidsoap programs, and for saving/editing the
program.</p>
<h2 id="running-a-script-file"><a href="#running-a-script-file"
class="anchor">Running a script file</a></h2>
<p>Write the interactive example expression in a file, say
<code>test.liq</code>.</p>
<ul>
<li>You can run it using <code>liquidsoap -t - &lt; test.liq</code>, you
get the same behavior as before.</li>
<li>If you run it using <code>liquidsoap -t test.liq</code> the logs
will be written in <code>test.log</code> in the default logging
directory. This can fail as you may not have access to that directory.
Change the directory using the setting (see <a href="help.html">how to
get help</a> about that) <code>log.file.path</code>. Then use the
settings <code>log.stdout</code> and <code>log.file</code> for logging
to the terminal and not to a file.</li>
<li>Finally, find the setting for getting rid of the <code>-t</code>
option on the command line.</li>
<li>You can also use <code>#!/usr/bin/liquidsoap</code> (adapt the path)
as the first line of your script to directly run <code>./test.liq</code>
instead of <code>liquidsoap test.liq</code> (you need to
<code>chmod +x test.liq</code>).</li>
</ul>
<p>You can also load several scripts and expression on the command line.
The last script or expression is taken as the main one, and determines
the logging behavior of liquidsoap.</p>
<h2 id="daemon-mode"><a href="#daemon-mode" class="anchor">Daemon
mode</a></h2>
<p>Finally, the <code>-d</code> command-line option (or
<code>init.daemon</code> setting) triggers the <em>daemon mode</em>
where liquidsoap detaches from the terminal to run in the
background.</p>
<h2 id="checking-a-media-file"><a href="#checking-a-media-file"
class="anchor">Checking a media file</a></h2>
<p>To check how liquidsoap sees a file, you can run
<code>liquidsoap -r &lt;FILE&gt;</code>. Liquidsoap will attempt to
decode the file and its metadata, and compute its duration. This is
(almost) the same process as used during streaming, so it can be used
for checking how something works (or doesn’t work).</p>
<h1 id="get-comfortable-with-the-language"><a
href="#get-comfortable-with-the-language" class="anchor">Get comfortable
with the language</a></h1>
<p>Although it’s easy to forget it when using simple liquidsoap
expressions, liquidsoap is a rich programming language. Below is a list
of simple exercises to get more comfortable with it. Those exercises do
not deal with sources and even less with radio, and might seem pretty
dull. But it’s useful to go through them and try to understand what’s
going on: it will allow you to avoid the most common mistakes later,
when trying to write more complex liquidsoap scripts.</p>
<p>You can write the following examples in a script and execute it, or
type them directly in your terminal, followed by ctrl-D, on the standard
input of <code>liquidsoap -</code>. You can also pass <code>-c</code> so
that liquidsoap does not warn you that it has no source to stream.</p>
<h2 id="using-variables"><a href="#using-variables" class="anchor">Using
variables</a></h2>
<p>Run the following script:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> = <span class="dv">42</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(x)</span></code></pre></div>
<p>As follows:</p>
<pre><code>% liquidsoap --no-stdlib -i /path/to/script.liq
x     : int
42
No output defined, nothing to do.</code></pre>
<p>Try to obtain the following types (some help can be found <a
href="language.html">there</a>):</p>
<ul>
<li><code>float</code></li>
<li><code>bool</code></li>
<li><code>string</code></li>
<li><code>[string]</code> (list of strings)</li>
<li><code>(bool*string)</code> (a pair made of a boolean and a
string)</li>
</ul>
<p>You can redefine a variable:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> = <span class="dv">42</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> = <span class="st">&quot;42&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> = (y,y)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="va">z</span> = (x,y)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(z)</span></code></pre></div>
<h2 id="defining-a-function"><a href="#defining-a-function"
class="anchor">Defining a function</a></h2>
<p>Try this:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="dt">double</span>(s)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  s ^ s</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="dt">double</span>(<span class="st">&quot;foo&quot;</span>))</span></code></pre></div>
<p>Change <code>^</code> for <code>+</code>. Liquidsoap will complain
that it cannot add strings; additions are only for numbers (integers and
floats). Adapt the last line to fix that problem.</p>
<h2 id="conditionals"><a href="#conditionals"
class="anchor">Conditionals</a></h2>
<p>A simple example:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="st">&quot;foo&quot;</span>==<span class="st">&quot;bar&quot;</span> <span class="kw">then</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">print</span>(<span class="st">&quot;This is madness.&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">print</span>(<span class="st">&quot;Phew.&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>It can also be written as follows:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="st">&quot;foo&quot;</span>==<span class="st">&quot;bar&quot;</span> <span class="kw">then</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;This is madness.&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Phew.&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">end</span>)</span></code></pre></div>
<p>Now, define the variable <code>message</code> to be the correct
message depending on the test, and finish by
<code>print(message)</code>. To do this, keep in mind the following: A
variable definition is local to the current scope. Redefining a new
variable does not erase or override previous definitions but only masks
them in the current scope. In other words, <em>definitions</em> should
not be confused with <em>assignments</em> (which are performed by
<code>x=...</code> in non-functional languages). You’ll learn later how
to use assignments when you really need them.</p>
<h2 id="sequencing-returning"><a href="#sequencing-returning"
class="anchor">Sequencing, returning</a></h2>
<p>Here is a function that prints the date and returns 42:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="dt">f</span>()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">print</span>(<span class="dt">get_process_output</span>(<span class="st">&quot;date&quot;</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">42</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s use it:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="dt">f</span>())</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="dt">print</span>(<span class="dv">1</span>+<span class="dt">f</span>())</span></code></pre></div>
<p>Note that there is no return statement in liquidsoap (in fact there
is no “statement” at all). Every expression evaluates to a value. A
sequence evaluates to the value of its last expression (<code>42</code>
in the body of the function <code>f</code>, and
<code>print(1+f())</code> in the full program). The value ``returned’’
by a function is simply the result of evaluating its body.</p>
<h2 id="labels-and-optional-parameters"><a
href="#labels-and-optional-parameters" class="anchor">Labels and
optional parameters</a></h2>
<p>In liquidsoap, functions arguments can be labeled or not. For
example, in <code>f(x,y,foo=z)</code> we pass <code>x</code> and
<code>y</code> as the first two unlabeled arguments, and <code>z</code>
for the argument labeled <code>foo</code>. Moreover, labeled arguments
can be optional: you saw this with most examples in this page, where
each operator had lots of parameters that you didn’t set (for example,
<code>track_sensitive</code> in <code>fallback</code>).</p>
<p>When reading the doc of a function, you see the type of the function,
followed by a description of its arguments. Often you can ignore the
type, but when you write an incorrect script, you might need to read
types to understand error messages. A function type is written
<code>(A1,..,AN)-&gt;T</code> where <code>T</code> is the type of values
returned by the function and each <code>Ai</code> specifies one
parameters:</p>
<ul>
<li>unlabeled parameters are simply given by their type (for example,
string concatenation has type
<code>(string,string)-&gt;string</code>);</li>
<li>mandatory labeled parameters are written <code>label:T</code> where
<code>T</code> is the type of the parameter;</li>
<li>optional labeled parameters are written <code>?label:T</code>.</li>
</ul>
<p>You will rarely have to define a function with labeled parameters,
but if you’re curious you can learn it <a
href="language.html">there</a>.</p>
<h2 id="what-you-cannot-do"><a href="#what-you-cannot-do"
class="anchor">What you cannot do</a></h2>
<p>Liquidsoap does not have <code>while</code> and <code>for</code>
loops, nor recursion. This is mostly because they are not really needed
(yet…), notably since functions like <code>list.map</code> and
<code>list.iter</code> are often a good replacement.</p>
          <div id="footer"></div>
        </main>
      </div>
    </div>
    <!--   Core JS Files   -->

    <script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/assets/js/liq-jquery.js" type="text/javascript"></script>
  </body>

</html>
