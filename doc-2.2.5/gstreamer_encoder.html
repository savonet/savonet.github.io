<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Liquidsoap</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!-- Extra details for Live View on GitHub Pages -->
    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.liquidsoap.info/" />
    <!--  Social tags      -->
    <meta name="keywords" content="radio, audio, video, streaming, icecast, shoutcast">
    <meta name="description" content="Swiss-army knife for multimedia streaming">
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Liquidsoap Streaming Language">
    <meta itemprop="description" content="Swiss-army knife for multimedia streaming">
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@LiquidsoapMedia">
    <meta name="twitter:title" content="Liquidsoap Streaming Language">
    <meta name="twitter:description" content="Swiss-army knife for multimedia streaming">
    <meta name="twitter:creator" content="@LiquidsoapMedia">
    <meta name="twitter:image" content="https://www.liquidsoap.info//assets/img/bottle_invert.png">
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="/assets/css/custom.css" rel="stylesheet" />
    <link href="/assets/css/material-kit.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <!-- Documentation extras -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="/assets/demo/docs.min.css">
    <style>
    .navbar-absolute-logo {
      padding-left: 45px;
    }

    .navbar-absolute-logo img {
      position: absolute;
      left: 15px;
      margin-top: -6px;
    }

    body {
      background: white;
    }

    p {
        font-size: 16px;
        text-align: justify;
    }
    </style>
  </head>

  <body class="bd-docs" data-spy="scroll" data-target=".bd-sidenav-active">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <header class="navbar navbar-expand navbar-dark bg-primary flex-column flex-md-row bd-navbar">
      <a class="navbar-brand mr-0 mr-md-2 navbar-absolute-logo" href="/doc-2.2.5">
        <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 600 600" focusable="false" style="width: 25px; height: 25px;">
          <title>Liquidsoap</title>
          <style type="text/css">
.st0{fill:#FFFFFF;}
          </style>
          <g>
          <path class="st0" d="M102.4,593.8c-0.7-2.8-3.4-2.5-5.3-3.3c-24.6-10.2-37.2-28.7-37.2-55.6c-0.1-72.1,0-144.2,0-216.3
          c0-52.3,0-104.6,0-156.9c0-37.6,23.1-60.9,60.6-61.1c12-0.1,23.9-0.2,35.9,0c15.7,0.3,26.7,10.1,26.3,23
          c-0.4,12.5-11.1,21.5-26.3,21.8c-12,0.2-23.9-0.1-35.9,0.1c-11.8,0.1-15.6,3.7-15.6,15.3c-0.1,124.4,0,248.8-0.1,373.2
          c0,10.3,4.5,15.1,14.8,15.1c69.1-0.1,138.2,0,207.3-0.1c12.3,0,15.5-3.7,15.5-17.7c0-74.7,0-149.4,0-224.2c0-47.8,0-95.6,0-143.5
          c0-15.2-3-18.1-18.4-18.2c-10.8,0-21.7,0.1-32.5,0c-16-0.2-26.7-9.4-26.6-22.5c0.1-13,10.9-22.1,26.9-22.3
          c13.4-0.2,26.9-0.3,40.3,0.1c30.8,1,54.9,24.5,55,55.2c0.3,127.4,0.3,254.8,0.1,382.2c0,25.5-15.8,45.7-40.2,53.3
          c-1.7,0.5-3.8,0-4.5,2.4C262.3,593.8,182.4,593.8,102.4,593.8z"/>
          <path class="st0" d="M537.4,212.6c-16.8,23-56.5,16.5-68.6-9.5c-8-17.2-12.4-32.7-12-54.5c4.6,4.1,8.3,7.5,12.1,10.7
          c10.3,8.6,21,14,35.5,11.8c12.5-1.9,21.5,6,28.2,16.3c2,3,1.3,7.3,4.8,9.5C537.4,202.2,537.4,207.4,537.4,212.6z"/>
          <path class="st0" d="M200.6,230.4c0-55.3,0-110.5,0-165.8c0-40.7,22.3-62.7,63.2-62.7c50.4,0,100.8,0,151.3,0
          c36.1,0,59.1,21.9,60.4,57.7c0.5,13.1,0.4,26.1,0,39.2c-0.4,15.1-10.1,25.8-22.5,25.7c-12-0.1-21.6-10.1-22.3-24.8
          c-0.6-12.7-0.4-25.4-0.1-38.1c0.2-10.4-4.5-14.9-14.9-14.9c-51.5,0.1-103.1,0-154.6,0.1c-12.7,0-15.5,3.2-15.5,17.5
          c0,105.3,0,210.6,0,316c0,7.8,0.1,15.7,0,23.5c-0.2,17.5-9.4,28.9-23,28.6c-13.5-0.3-21.9-10.9-21.9-28.3
          C200.6,346.2,200.6,288.3,200.6,230.4z"/>
          </g>
        </svg>
        Liquidsoap
      </a>
      <ul class="navbar-nav flex-row d-none d-md-flex">
        <li class="nav-item dropdown">
          <a data-versions="dev 2.1.4 2.2.5 2.3.0 2.3.1 2.3.2
2.3.3" data-version="2.2.5" class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="liq-version" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            2.2.5
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="liq-version" id="liq-versions">
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/savonet/liquidsoap" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false">
              <title>GitHub</title>
              <path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd" />
            </svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://twitter.com/liquidsoapmedia" target="_blank" rel="noopener" aria-label="Twitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false">
              <title>Twitter</title>
              <path d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92" fill="currentColor" />
            </svg>
          </a>
        </li>
      </ul>
      <div class="navbar-nav-scroll ml-md-auto ">
        <ul class="navbar-nav bd-navbar-nav flex-row">
          <!--
            <li class="nav-item">
            <a class="nav-link" href=""> <i class="material-icons">card_membership</i> PRO Services </a>
            </li>
            -->
          <li class="nav-item">
            <script async src="https://cse.google.com/cse.js?cx=24f50f6f088994c53"></script>
            <style>
.cse .gsc-control-cse, .gsc-control-cse {
  background-color: transparent;
  border: none;
  width: 300px;
}
            </style>
            <div class="gcse-search"></div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/savonet/liquidsoap/issues" target="_blank" rel="noopener"><i class="material-icons">star</i> Get Help</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/savonet/liquidsoap" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#9c27b0; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
      </a>
      <style>
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out
}

        @keyframes octocat-wave {
          0%,
          100% {
            transform: rotate(0)
          }
          20%,
          60% {
            transform: rotate(-25deg)
          }
          40%,
          80% {
            transform: rotate(10deg)
          }
        }

        @media (max-width:500px) {
          .github-corner:hover .octo-arm {
            animation: none
          }
          .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out
          }
        }
      </style>
    </header>
    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
          <nav class="collapse bd-links" id="bd-docs-nav">
            <div class="bd-toc-item active">
              <ul class="nav bd-sidenav">
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/doc-2.2.5/install.html">
                    Install
                  </a>
                </li>
                <li>
                  <a href="/doc-2.2.5/migrating.html">
                    Migrating from previous versions
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="#">
                    Starters
                  </a>
                </li>
                <li><a href="/doc-2.2.5/book.html">The book</a></li>
                <li>
                  <a href="/doc-2.2.5/presentations.html">Video Presentations</a>
                </li>
                <li>
                  <a href="/doc-2.2.5/help.html">How to find help</a>
                </li>
                <li>
                  <a href="/doc-2.2.5/faq.html">Frequently Asked Questions</a>
                </li>
                <li><a href="/doc-2.2.5/quick_start.html">Quickstart</a></li>
                <li>
                  <a href="/doc-2.2.5/complete_case.html">Complete case analysis</a>
                </li>
                <li>
                  <a href="/doc-2.2.5/cookbook.html">Cookbook</a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Reference
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.2.5/language.html">Script language</a></li>
                <li>
                  <a href="/doc-2.2.5/reference.html">Core API</a></li>
                <li>
                  <a href="/doc-2.2.5/reference-extras.html">Extra API</a></li>
                <li>
                  <a href="/doc-2.2.5/reference-deprecated.html">Deprecated API</a></li>
                <li>
                  <a href="/doc-2.2.5/multitrack.html">Multitrack</a></li>
                <li>
                  <a href="/doc-2.2.5/protocols.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.2.5/settings.html">Settings</a></li>
                <li>
                  <a href="/doc-2.2.5/ffmpeg.html">FFmpeg support</a></li>
                <li>
                  <a href="/doc-2.2.5/encoding_formats.html">Encoding formats</a></li>
                <li>
                  <a href="/doc-2.2.5/video.html">Videos streams</a></li>
                <li>
                  <a href="/doc-2.2.5/memory.html">Memory management</a></li>
                <li>
                  <a href="/doc-2.2.5/json.html">JSON import/export</a></li>
                <li>
                  <a href="/doc-2.2.5/yaml.html">YAML import/export</a></li>
                <li>
                  <a href="/doc-2.2.5/ladspa.html">LADSPA plugins</a></li>
                <li>
                  <a href="/doc-2.2.5/playlist_parsers.html">Playlist parsers</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Core
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.2.5/sources.html">Sources</a></li>
                <li>
                  <a href="/doc-2.2.5/clocks.html">Clocks</a></li>
                <li>
                  <a href="/doc-2.2.5/requests.html">Requests</a></li>
                <li>
                  <a href="/doc-2.2.5/protocols-presentation.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.2.5/stream_content.html">Stream contents</a></li>
                <li>
                  <a href="/doc-2.2.5/strings_encoding.html">Strings encoding</a></li>
                <li>
                  <a href="/doc-2.2.5/script_loading.html">Script loading</a></li>
                <li><a href="/doc-2.2.5/phases.html">Execution phases</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Specific tutorials
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.2.5/harbor_http.html">Using the HTTP server</a></li>
                <li>
                  <a href="/doc-2.2.5/blank.html">Blank detection</a></li>
                <li>
                  <a href="/doc-2.2.5/metadata.html">Customize metadata</a></li>
                <li>
                  <a href="/doc-2.2.5/seek.html">Seek and cue support</a></li>
                <li>
                  <a href="/doc-2.2.5/external_decoders.html">External decoders</a></li>
                <li>
                  <a href="/doc-2.2.5/external_streams.html">External streams</a></li>
                <li>
                  <a href="/doc-2.2.5/external_encoders.html">External encoders</a></li>
                <li>
                  <a href="/doc-2.2.5/hls_output.html">HLS output</a></li>
                <li>
                  <a href="/doc-2.2.5/http_input.html">HTTP input</a></li>
                <li>
                  <a href="/doc-2.2.5/harbor.html">Harbor input</a></li>
                <li>
                  <a href="/doc-2.2.5/stereotool.html">Stereotool</a></li>
                <li>
                  <a href="/doc-2.2.5/server.html">Using the telnet server</a></li>
                <li>
                  <a href="/doc-2.2.5/icy_metadata.html">ICY metadata update</a></li>
                <li>
                  <a href="/doc-2.2.5/replay_gain.html">Normalization and replay gain</a></li>
                <li>
                  <a href="/doc-2.2.5/request_sources.html">Requests-based sources</a></li>
                <li>
                  <a href="/doc-2.2.5/shoutcast.html">Shoutcast output</a></li>
                <li>
                  <a href="/doc-2.2.5/dynamic_sources.html">Dynamic source creation</a></li>
                <li>
                  <a href="/doc-2.2.5/crossfade.html">Crossfading</a></li>
                <li>
                  <a href="/doc-2.2.5/in_production.html">Using in production</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    User scripts
                  </a>
                </li>
                <li>
                  <a href="/doc-2.2.5/beets.html">Beets</a></li>
                <li>
                  <a href="/doc-2.2.5/geekradio.html">Geekradio</a></li>
                <li>
                  <a href="/doc-2.2.5/radiopi.html">RadioPi</a></li>
                <li>
                  <a href="/doc-2.2.5/dolebrai.html">Dolebraï</a></li>
                <li>
                  <a href="/doc-2.2.5/frequence3.html">Frequence3</a></li>
                <li>
                  <a href="/doc-2.2.5/video-static.html">Video with a single static image</a></li>
                <li>
                  <a href="/doc-2.2.5/split-cue.html">Split a CUE sheet</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    Behind the curtains
                  </a>
                </li>
                <li>
                  <a href="/doc-2.2.5/publications.html">Some presentations and publications</a></li>
                <li>
                  <a href="https://github.com/savonet">OCaml libraries</a></li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/legacy">
                    Legacy website
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <!--
          <div class="d-none d-xl-block col-xl-2 bd-toc">
          <ul class="section-nav">
          <li class="toc-entry toc-h2">
          <a href="#quick-start">Quick start</a>
          <ul>
          <li class="toc-entry toc-h3">
          <a href="#css">CSS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#js">JS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#fonts-and-icons">Fonts and Icons</a>
          </li>
          </ul>
          </li>
          <li class="toc-entry toc-h2">
          <a href="#starter-template">Starter template</a>
          </li>
          </ul>
          </div>
        -->
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
          <h1 id="the-gstreamer-encoder"><a
href="#the-gstreamer-encoder" class="anchor">The Gstreamer
encoder</a></h1>
<p>The <code>%gstreamer</code> encoder can be used to encode streams
using the <code>gstreamer</code> multimedia framework. This encoder
extends liquidsoap with all available GStreamer formats (provided they
are compatible with liquidsoap’s model of streams, see Caveats section
below), which includes a huge array of encoders.</p>
<h2 id="presentation"><a href="#presentation"
class="anchor">Presentation</a></h2>
<p>A basic understanding of gstreamer’s pipelines and configuration
should be expected in order to understand the following
documentation.</p>
<p>The encoder’s parameters are as follows:</p>
<pre><code>%gstreamer(channels=2,
           audio=&quot;lamemp3enc&quot;,
           has_video=true,
           video=&quot;x264enc&quot;,
           muxer=&quot;mpegtsmux&quot;,
           metadata=&quot;metadata&quot;,
           log=5,
           pipeline=&quot;&quot;)</code></pre>
<p>Without using the <code>pipeline</code> argument, the
<code>audio</code> and <code>video</code> arguments are used to build
the gstreamer pipeline used to encode. By setting the <code>log</code>
parameter to a lower value or by using <code>log.level := ...</code>,
you should be able to see some example.</p>
<h2 id="basic-examples"><a href="#basic-examples" class="anchor">Basic
examples</a></h2>
<p>Here are a couple of examples:</p>
<p>An MP3 encoder that expects sources of type
<code>audio=2, video=0, midi=0</code>:</p>
<pre><code>% liquidsoap &#39;output.file(%gstreamer(audio=&quot;lamemp3enc&quot;,
                                     muxer=&quot;&quot;,
                                     video=&quot;&quot;,
                                     log=3),...)&#39;
(...)
2012/12/13 19:16:23 [encoder.gstreamer:3] Gstreamer encoder pipeline: appsrc
  name=&quot;audio_src&quot; block=true caps=&quot;audio/x-raw,format=S16LE,layout=interleaved,
  channels=2,rate=44100&quot; format=time ! queue ! audioconvert ! audioresample !
  lamemp3enc ! appsink name=sink sync=false emit-signals=true</code></pre>
<p>A x264 encoder that expects sources of type
<code>audio=0, video=1, midi=0</code>:</p>
<pre><code>% liquidsoap &#39;output.file(%gstreamer(audio=&quot;&quot;,
                                     muxer=&quot;mpegtsmux&quot;,
                                     video=&quot;x264enc&quot;,
                                     log=3),...)&#39;
(...)
2012/12/13 19:14:43 [encoder.gstreamer:3] Gstreamer encoder pipeline:  appsrc
  name=&quot;video_src&quot; block=true caps=&quot;video/x-raw,format=RGBA,width=320,height=240,
  framerate=25/1,pixel-aspect-ratio=1/1&quot; format=time blocksize=307200 ! queue !
  videoconvert ! videoscale add-borders=true ! videorate ! x264enc !
  mpegtsmux name=muxer ! appsink name=sink sync=false emit-signals=true</code></pre>
<p>An MPEG TS encoder that expects sources of type
<code>audio=2, video=1, midi=0</code>:</p>
<pre><code>% liquidsoap &#39;output.file(%gstreamer(audio=&quot;lamemp3enc&quot;,
                                     muxer=&quot;mpegtsmux&quot;,
                                     video=&quot;x264enc&quot;,
                                     log=3),...)&#39;
(...)
2012/12/13 19:18:09 [encoder.gstreamer:3] Gstreamer encoder pipeline: appsrc
  name=&quot;audio_src&quot; block=true caps=&quot;audio/x-raw,format=S16LE,
  layout=interleaved,channels=2,rate=44100&quot; format=time ! queue ! audioconvert
  ! audioresample ! lamemp3enc ! muxer. appsrc name=&quot;video_src&quot; block=true
  caps=&quot;video/x-raw,format=RGBA,width=320,height=240,framerate=25/1,
  pixel-aspect-ratio=1/1&quot; format=time blocksize=307200 ! queue ! videoconvert
  ! videoscale add-borders=true ! videorate ! x264enc ! muxer. mpegtsmux
  name=muxer ! appsink name=sink sync=false emit-signals=true</code></pre>
<p>An ogg/vorbis+theora encoder that expects source of type
<code>audio=1, video=1, midi=0</code>:</p>
<pre><code>% liquidsoap &#39;output.file(%gstreamer(audio=&quot;vorbisenc&quot;,
                                     muxer=&quot;oggmux&quot;,
                                     video=&quot;theoraenc&quot;,
                                     channels=1,
                                     log=3),...)&#39;
(...)
2012/12/13 19:21:17 [encoder.gstreamer:3] Gstreamer encoder pipeline: appsrc
  name=&quot;audio_src&quot; block=true caps=&quot;audio/x-raw,format=S16LE,layout=interleaved,
  channels=1,rate=44100&quot; format=time ! queue ! audioconvert ! audioresample !
  vorbisenc ! muxer. appsrc name=&quot;video_src&quot; block=true caps=&quot;video/x-raw,
  format=RGBA,width=320,height=240,framerate=25/1,pixel-aspect-ratio=1/1&quot;
  format=time blocksize=307200 ! queue ! videoconvert ! videoscale add-borders=true
  ! videorate ! theoraenc ! muxer. oggmux name=muxer ! appsink name=sink
  sync=false emit-signals=true</code></pre>
<p>For advanced users, the <code>pipeline</code> argument can be used to
override the whole pipeline. For instance:</p>
<pre><code>% liquidsoap &#39;output.file(%gstreamer(pipeline=&quot;appsrc name=\&quot;audio_src\&quot;
    block=true caps=\&quot;audio/x-raw,format=S16LE,layout=interleaved,
    channels=1,rate=44100\&quot; format=time ! lamemp3enc ! appsink name=sink
    sync=false emit-signals=true&quot;,channels=1,log=3),...)&#39;
(...)</code></pre>
<h2 id="content-type-inference"><a href="#content-type-inference"
class="anchor">Content type inference</a></h2>
<p>When starting its sources and outputs, liquidsoap determines the
content type of each source (audio, video and midi channels). During
that process, encoders have to inform liquidsoap what type of sources
they are expecting. It works as follows for the <code>%gstreamer</code>
encoder:</p>
<ul>
<li>If the <code>audio</code> parameter is a string different than
<code>""</code> then the encoder expects a stream with
<code>channels</code> audio channels.</li>
<li>If the <code>video</code> parameter is a string different than
<code>""</code> then the encoder expects a stream with <code>1</code>
video channel.</li>
<li>If the <code>pipeline</code> parameter is a string different than
<code>""</code> then the encoder expects a stream with
<code>channels</code> audio channels and a video channels only if
<code>has_video</code> is true.</li>
</ul>
<p>The <code>has_video</code> parameter is only used when using the
<code>pipeline</code> parameter.</p>
<h2 id="metadata"><a href="#metadata" class="anchor">Metadata</a></h2>
<p>The <code>%gstreamer</code> encoder tries to also encode metadata
attached to the stream. This requires that you specify a pipeline
element named according to the <code>metadata</code> parameter (default:
<code>"metadata"</code>) that can be used with GStreamer’s
<code>tag_setter</code> API. Here are two such examples:</p>
<p>An ogg/vorbis encoder with vorbis tags:</p>
<pre><code>% liquidsoap &#39;output.file(%gstreamer(audio=&quot;vorbisenc ! vorbistag name=&#39;metadata&#39;&quot;,
                                     muxer=&quot;oggmux&quot;,
                                     video=&quot;&quot;),...)&#39;</code></pre>
<p>An MP3 encoder with id3v2 tags:</p>
<pre><code>% liquidsoap &#39;output.file(%gstreamer(audio=&quot;lamemp3enc&quot;,
                                     muxer=&quot;id3v2mux&quot;,
                                     video=&quot;&quot;,
                                     metadata=&quot;muxer&quot;),...)&#39;</code></pre>
<p>In the last example, we tell the <code>%gstreamer</code> encoder that
the element for injecting metadata is named <code>"muxer"</code>
because, for id3v2 tags, the gstreamer muxer element is also the element
used to inject metadata and the <code>"muxer"</code> name is implicitly
added by liquidsoap to the muxer element. You can see that by printing
out the constructed pipeline, as shown before.</p>
<h2 id="caveats"><a href="#caveats" class="anchor">Caveats</a></h2>
<p>When using the <code>%gstreamer</code> encoder, one must think of it
as an encoder for an infinite stream. This, in particular, means that
not all containers (muxers) will work. For instance, the AVI and MP4
containers need to write in their header information that are only known
with finite streams, such as the stream total’s time and etc.. These
containers are usually not fit for streaming, which is liquidsoap’s main
functionality.</p>
          <div id="footer"></div>
        </main>
      </div>
    </div>
    <!--   Core JS Files   -->

    <script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/assets/js/liq-jquery.js" type="text/javascript"></script>
  </body>

</html>
