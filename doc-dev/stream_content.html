<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Liquidsoap</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!-- Extra details for Live View on GitHub Pages -->
    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.liquidsoap.info/" />
    <!--  Social tags      -->
    <meta name="keywords" content="radio, audio, video, streaming, icecast, shoutcast">
    <meta name="description" content="Swiss-army knife for multimedia streaming">
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Liquidsoap Streaming Language">
    <meta itemprop="description" content="Swiss-army knife for multimedia streaming">
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@LiquidsoapMedia">
    <meta name="twitter:title" content="Liquidsoap Streaming Language">
    <meta name="twitter:description" content="Swiss-army knife for multimedia streaming">
    <meta name="twitter:creator" content="@LiquidsoapMedia">
    <meta name="twitter:image" content="https://www.liquidsoap.info//assets/img/bottle_invert.png">
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="/assets/css/custom.css" rel="stylesheet" />
    <link href="/assets/css/material-kit.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <!-- Documentation extras -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="/assets/demo/docs.min.css">
    <style>
    .navbar-absolute-logo {
      padding-left: 45px;
    }

    .navbar-absolute-logo img {
      position: absolute;
      left: 15px;
      margin-top: -6px;
    }

    body {
      background: white;
    }

    p {
        font-size: 16px;
        text-align: justify;
    }
    </style>
    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  </head>

  <body class="bd-docs" data-spy="scroll" data-target=".bd-sidenav-active">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <header class="navbar navbar-expand navbar-dark bg-primary flex-column flex-md-row bd-navbar">
      <a class="navbar-brand mr-0 mr-md-2 navbar-absolute-logo" href="/doc-dev">
        <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 600 600" focusable="false" style="width: 25px; height: 25px;">
          <title>Liquidsoap</title>
          <style type="text/css">
.st0{fill:#FFFFFF;}
          </style>
          <g>
          <path class="st0" d="M102.4,593.8c-0.7-2.8-3.4-2.5-5.3-3.3c-24.6-10.2-37.2-28.7-37.2-55.6c-0.1-72.1,0-144.2,0-216.3
          c0-52.3,0-104.6,0-156.9c0-37.6,23.1-60.9,60.6-61.1c12-0.1,23.9-0.2,35.9,0c15.7,0.3,26.7,10.1,26.3,23
          c-0.4,12.5-11.1,21.5-26.3,21.8c-12,0.2-23.9-0.1-35.9,0.1c-11.8,0.1-15.6,3.7-15.6,15.3c-0.1,124.4,0,248.8-0.1,373.2
          c0,10.3,4.5,15.1,14.8,15.1c69.1-0.1,138.2,0,207.3-0.1c12.3,0,15.5-3.7,15.5-17.7c0-74.7,0-149.4,0-224.2c0-47.8,0-95.6,0-143.5
          c0-15.2-3-18.1-18.4-18.2c-10.8,0-21.7,0.1-32.5,0c-16-0.2-26.7-9.4-26.6-22.5c0.1-13,10.9-22.1,26.9-22.3
          c13.4-0.2,26.9-0.3,40.3,0.1c30.8,1,54.9,24.5,55,55.2c0.3,127.4,0.3,254.8,0.1,382.2c0,25.5-15.8,45.7-40.2,53.3
          c-1.7,0.5-3.8,0-4.5,2.4C262.3,593.8,182.4,593.8,102.4,593.8z"/>
          <path class="st0" d="M537.4,212.6c-16.8,23-56.5,16.5-68.6-9.5c-8-17.2-12.4-32.7-12-54.5c4.6,4.1,8.3,7.5,12.1,10.7
          c10.3,8.6,21,14,35.5,11.8c12.5-1.9,21.5,6,28.2,16.3c2,3,1.3,7.3,4.8,9.5C537.4,202.2,537.4,207.4,537.4,212.6z"/>
          <path class="st0" d="M200.6,230.4c0-55.3,0-110.5,0-165.8c0-40.7,22.3-62.7,63.2-62.7c50.4,0,100.8,0,151.3,0
          c36.1,0,59.1,21.9,60.4,57.7c0.5,13.1,0.4,26.1,0,39.2c-0.4,15.1-10.1,25.8-22.5,25.7c-12-0.1-21.6-10.1-22.3-24.8
          c-0.6-12.7-0.4-25.4-0.1-38.1c0.2-10.4-4.5-14.9-14.9-14.9c-51.5,0.1-103.1,0-154.6,0.1c-12.7,0-15.5,3.2-15.5,17.5
          c0,105.3,0,210.6,0,316c0,7.8,0.1,15.7,0,23.5c-0.2,17.5-9.4,28.9-23,28.6c-13.5-0.3-21.9-10.9-21.9-28.3
          C200.6,346.2,200.6,288.3,200.6,230.4z"/>
          </g>
        </svg>
        Liquidsoap
      </a>
      <ul class="navbar-nav flex-row d-none d-md-flex">
        <li class="nav-item dropdown">
          <a data-versions="dev 2.2.5 2.3.0 2.3.1 2.3.2 2.3.3
2.4.0" data-version="dev" class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="liq-version" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            dev
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="liq-version" id="liq-versions">
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/savonet/liquidsoap" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false">
              <title>GitHub</title>
              <path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd" />
            </svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://twitter.com/liquidsoapmedia" target="_blank" rel="noopener" aria-label="Twitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false">
              <title>Twitter</title>
              <path d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92" fill="currentColor" />
            </svg>
          </a>
        </li>
      </ul>
      <div class="navbar-nav-scroll ml-md-auto ">
        <ul class="navbar-nav bd-navbar-nav flex-row">
          <!--
            <li class="nav-item">
            <a class="nav-link" href=""> <i class="material-icons">card_membership</i> PRO Services </a>
            </li>
            -->
          <li class="nav-item">
            <script async src="https://cse.google.com/cse.js?cx=24f50f6f088994c53"></script>
            <style>
.cse .gsc-control-cse, .gsc-control-cse {
  background-color: transparent;
  border: none;
  width: 300px;
}
            </style>
            <div class="gcse-search"></div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/savonet/liquidsoap/issues" target="_blank" rel="noopener"><i class="material-icons">star</i> Get Help</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/savonet/liquidsoap" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#9c27b0; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
      </a>
      <style>
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out
}

        @keyframes octocat-wave {
          0%,
          100% {
            transform: rotate(0)
          }
          20%,
          60% {
            transform: rotate(-25deg)
          }
          40%,
          80% {
            transform: rotate(10deg)
          }
        }

        @media (max-width:500px) {
          .github-corner:hover .octo-arm {
            animation: none
          }
          .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out
          }
        }
      </style>
    </header>
    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
          <nav class="collapse bd-links" id="bd-docs-nav">
            <div class="bd-toc-item active">
              <ul class="nav bd-sidenav">
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/doc-dev/install.html">
                    Install
                  </a>
                </li>
                <li>
                  <a href="/doc-dev/migrating.html">
                    Migrating from previous versions
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="#">
                    Starters
                  </a>
                </li>
                <li><a href="/doc-dev/book.html">The book</a></li>
                <li>
                  <a href="/doc-dev/presentations.html">Video Presentations</a>
                </li>
                <li>
                  <a href="/doc-dev/help.html">How to find help</a>
                </li>
                <li>
                  <a href="/doc-dev/faq.html">Frequently Asked Questions</a>
                </li>
                <li><a href="/doc-dev/quick_start.html">Quickstart</a></li>
                <li>
                  <a href="/doc-dev/complete_case.html">Complete case analysis</a>
                </li>
                <li>
                  <a href="/doc-dev/cookbook.html">Cookbook</a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Reference
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-dev/language.html">Script language</a></li>
                <li>
                  <a href="/doc-dev/reference.html">Core API</a></li>
                <li>
                  <a href="/doc-dev/reference-extras.html">Extra API</a></li>
                <li>
                  <a href="/doc-dev/reference-deprecated.html">Deprecated API</a></li>
                <li>
                  <a href="/doc-dev/protocols.html">Protocols</a></li>
                <li>
                  <a href="/doc-dev/settings.html">Settings</a></li>
              </ul>
              <a class="bd-toc-link" href="#">
                Basic Concepts
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-dev/multitrack.html">Multitrack</a></li>
                <li>
                  <a href="/doc-dev/latency_control.html">Latency control</a></li>
                <li>
                  <a href="/doc-dev/scheduling.html">Scheduling</a></li>
                <li>
                  <a href="/doc-dev/ffmpeg.html">FFmpeg support</a></li>
                <li>
                  <a href="/doc-dev/encoding_formats.html">Encoding formats</a></li>
                <li>
                  <a href="/doc-dev/video.html">Videos streams</a></li>
                <li>
                  <a href="/doc-dev/memory.html">Memory management</a></li>
                <li>
                  <a href="/doc-dev/json.html">JSON import/export</a></li>
                <li>
                  <a href="/doc-dev/xml.html">XML import/export</a></li>
                <li>
                  <a href="/doc-dev/yaml.html">YAML import/export</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Core Concepts
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-dev/sources.html">Sources</a></li>
                <li>
                  <a href="/doc-dev/clocks.html">Clocks</a></li>
                <li>
                  <a href="/doc-dev/requests.html">Requests</a></li>
                <li>
                  <a href="/doc-dev/protocols-presentation.html">Protocols</a></li>
                <li>
                  <a href="/doc-dev/stream_content.html">Stream contents</a></li>
                <li>
                  <a href="/doc-dev/strings_encoding.html">Strings encoding</a></li>
                <li>
                  <a href="/doc-dev/script_loading.html">Script loading</a></li>
                <li><a href="/doc-dev/phases.html">Execution phases</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Specific tutorials
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-dev/harbor_http.html">Using the HTTP server</a></li>
                <li>
                  <a href="/doc-dev/playlist_parsers.html">Playlist parsers</a></li>
                <li>
                  <a href="/doc-dev/blank.html">Blank detection</a></li>
                <li>
                  <a href="/doc-dev/metadata.html">Customize metadata</a></li>
                <li>
                  <a href="/doc-dev/seek.html">Seek and cue support</a></li>
                <li>
                  <a href="/doc-dev/external_decoders.html">External decoders</a></li>
                <li>
                  <a href="/doc-dev/external_streams.html">External streams</a></li>
                <li>
                  <a href="/doc-dev/external_encoders.html">External encoders</a></li>
                <li>
                  <a href="/doc-dev/ladspa.html">LADSPA plugins</a></li>
                <li>
                  <a href="/doc-dev/hls_output.html">HLS output</a></li>
                <li>
                  <a href="/doc-dev/http_input.html">HTTP input</a></li>
                <li>
                  <a href="/doc-dev/harbor.html">Harbor input</a></li>
                <li>
                  <a href="/doc-dev/stereotool.html">Stereotool</a></li>
                <li>
                  <a href="/doc-dev/server.html">Using the telnet server</a></li>
                <li>
                  <a href="/doc-dev/icy_metadata.html">ICY metadata update</a></li>
                <li>
                  <a href="/doc-dev/replay_gain.html">Normalization and replay gain</a></li>
                <li>
                  <a href="/doc-dev/request_sources.html">Requests-based sources</a></li>
                <li>
                  <a href="/doc-dev/shoutcast.html">Shoutcast output</a></li>
                <li>
                  <a href="/doc-dev/dynamic_sources.html">Dynamic source creation</a></li>
                <li>
                  <a href="/doc-dev/crossfade.html">Crossfading</a></li>
                <li>
                  <a href="/doc-dev/in_production.html">Using in production</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    User scripts
                  </a>
                </li>
                <li>
                  <a href="/doc-dev/beets.html">Beets</a></li>
                <li>
                  <a href="/doc-dev/geekradio.html">Geekradio</a></li>
                <li>
                  <a href="/doc-dev/radiopi.html">RadioPi</a></li>
                <li>
                  <a href="/doc-dev/dolebrai.html">Dolebraï</a></li>
                <li>
                  <a href="/doc-dev/frequence3.html">Frequence3</a></li>
                <li>
                  <a href="/doc-dev/video-static.html">Video with a single static image</a></li>
                <li>
                  <a href="/doc-dev/split-cue.html">Split a CUE sheet</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    Behind the curtains
                  </a>
                </li>
                <li>
                  <a href="/doc-dev/publications.html">Some presentations and publications</a></li>
                <li>
                  <a href="https://github.com/savonet">OCaml libraries</a></li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/legacy">
                    Legacy website
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <!--
          <div class="d-none d-xl-block col-xl-2 bd-toc">
          <ul class="section-nav">
          <li class="toc-entry toc-h2">
          <a href="#quick-start">Quick start</a>
          <ul>
          <li class="toc-entry toc-h3">
          <a href="#css">CSS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#js">JS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#fonts-and-icons">Fonts and Icons</a>
          </li>
          </ul>
          </li>
          <li class="toc-entry toc-h2">
          <a href="#starter-template">Starter template</a>
          </li>
          </ul>
          </div>
        -->
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
          <h1 id="stream-contents"><a href="#stream-contents"
class="anchor">Stream contents</a></h1>
<p>In liquidsoap, a stream may contain any number of audio, video and
event MIDI channels (though this has not been tested in a while!). As
part of the type checking of your script, liquidsoap checks that you
make a consistent use of stream contents, and also guesses what kind of
stream your script is intended to work on. As with other inferred
parameters, you do not necessarily need to read about stream contents
typing if you’re still learning the ropes of liquidsoap, but you might
eventually need to know a little about it.</p>
<p>In liquidsoap script language, there are three sorts of objects that
rely on stream types: sources, requests and encoding formats. A <a
href="sources.html">source</a> produces a stream, and it is important
what kind of stream it produces when composing it with other sources. A
<a href="requests.html">request</a> is an abstract notion of file, often
meant to be decoded, and it is useful to know into what kind of stream
it is meant to be decoded. Finally, a <a
href="encoding_formats.html">format</a> describes how a stream should be
encoded (<em>e.g.</em>, before output in a file or via icecast), and the
stream content is also useful here for the format to make sense.</p>
<p>In this page, we explain how liquidsoap uses stream types to guess
and check what you’re doing.</p>
<h2 id="content-types"><a href="#content-types" class="anchor">Content
types</a></h2>
<p>Liquidsoap supports various type of content to be produced as the
script runs.</p>
<h3 id="internal-content"><a href="#internal-content"
class="anchor">Internal content</a></h3>
<p><em>internal</em> content generally refers to content that the
liquidsoap application can produce and manipulate.</p>
<p>For audio, the default internal content is <code>pcm</code> floats
using OCaml native 64-bits float array representations. This is the
format that allows the fastest manipulation.</p>
<p>For video, the default is a C in-memory arrays of plannar YUV420
data.</p>
<p>For users concerned with memory consumption, we also support two
additional audio formats, <code>pcm_s16</code> and <code>pcm_f32</code>
using, resp., signed 16-bit integers and 32-bit floating point numbers.
These formats may increase CPU usage, however, as we do need to convert
back and forth when using them in audio manipulation operators such as
<code>amplify</code>, <code>crossfade</code> and etc. See <a
href="memory.html#audio-data-format">this link</a> for more details.</p>
<h3 id="opaque-content"><a href="#opaque-content" class="anchor">Opaque
content</a></h3>
<p>Liquidsoap also supports content type that are opaque to the
application, provided by the <code>ffmpeg</code> decoder. There are
two:</p>
<ul>
<li>FFmpeg raw frames, which are decoded plain FFmpeg frames</li>
<li>FFmpeg packets, also referred to as FFmpeg copy content. These are
packets of encoded content</li>
</ul>
<p>These type of content are consumed by FFmpeg specific operators and
it is possible to convert back and forth if you want to use them with
our internal operators. However, their best use-case is to keep them
as-is end-to-end to optimize for memory and/or CPU usage.</p>
<p>See the <a href="ffmpeg.html">FFmpeg support</a> doc for more
information.</p>
<h2 id="global-parameters"><a href="#global-parameters"
class="anchor">Global parameters</a></h2>
<p>You might have noticed that our description of internal stream
contents is missing some information, such as sample rate, video size,
etc. Indeed, that information is not part of the stream types, which is
local to each source/request/format, but global in liquidsoap. You can
change it using the <code>frame.audio/video.*</code> settings, shown
here with their default values:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>audio.samplerate := <span class="dv">44100</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>video.frame.width := <span class="dv">320</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>video.frame.height := <span class="dv">240</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>video.frame.rate := <span class="dv">25</span></span></code></pre></div>
<h2 id="checking-stream-contents"><a href="#checking-stream-contents"
class="anchor">Checking stream contents</a></h2>
<p>Checking the consistency of use of stream contents is done as part of
type checking. There is not so much to say here, except that you have to
read type errors. We present a few examples.</p>
<p>For example, if you try to send an ALSA input to a SDL input using
<code>output.sdl(input.alsa())</code>, you’ll get the following:</p>
<pre><code>At line 1, char 22-23:
  this value has type
    source(audio=pcm(&#39;a))
  but it should be a subtype of
    source(video=canvas)</code></pre>
<p>It means that a source with a video channel was expected by the SDL
output, but the ALSA output can only offer sources producing audio.</p>
<h2 id="conversions"><a href="#conversions"
class="anchor">Conversions</a></h2>
<p>get a type error on seemingly meaningful code, and you’ll wonder how
to fix it. Often, it suffices to perform a few explicit conversions.</p>
<p>Consider another example involving the SDL output, where we also try
to use AO to output the audio content of a video:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">single</span>(<span class="st">&quot;file.mp4&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Output video here</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dt">output.file</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%ffmpeg</span>(<span class="ot">%video</span>(<span class="va">codec</span>=<span class="st">&quot;libx264&quot;</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;/path/to/video.flv&quot;</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  s</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Output audio here</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="dt">output.file</span>(</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%ffmpeg</span>(<span class="ot">%audio</span>(<span class="va">codec</span>=<span class="st">&quot;aac&quot;</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;/path/to/video.aac&quot;</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  s</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>This won’t work because the first output expects a video-only stream
while the second one expected an audio-only stream</p>
<p>The solution is to split the stream in two, dropping the irrelevant
content:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">single</span>(<span class="st">&quot;file.mp4&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Output video here</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dt">output.file</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%ffmpeg</span>(<span class="ot">%video</span>(<span class="va">codec</span>=<span class="st">&quot;libx264&quot;</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;/path/to/video.flv&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">source.drop.audio</span>(s)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Output audio here</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="dt">output.file</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%ffmpeg</span>(<span class="ot">%audio</span>(<span class="va">codec</span>=<span class="st">&quot;aac&quot;</span>))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;/path/to/video.aac&quot;</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">source.drop.video</span>(s)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Another conversion is muxing. It is useful to add audio/video
channels to a pure video/audio stream. For this, see
<code>source.mux.video</code> and <code>source.mux.audio</code>.</p>
<h2 id="type-annotations"><a href="#type-annotations"
class="anchor">Type annotations</a></h2>
<p>You now have all the tools to write a correct script. But you might
still be surprised by what stream content liquidsoap guesses you want to
use. This is very important, because even if liquidsoap finds a type for
which it accepts to run, it might not run as you intend: a different
type might mean a different behavior (not the intended number of audio
channels, no video, etc).</p>
<p>Before reading on how liquidsoap performs this inference, you can
already work your way to the intended type by using type
annotations.</p>
<p>For example, with <code>output.alsa(input.alsa())</code>, you’ll see
that liquidsoap decides that stereo audio should be used, and
consequently the ALSA I/O will be initialized with two channels. If you
want to use a different number of channels, for example mono, you can
explicitly specify it using:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dt">output.alsa</span>((<span class="dt">input.alsa</span>():<span class="dt">source</span>(<span class="va">audio</span>=<span class="dt">pcm</span>(mono))))</span></code></pre></div>
<h2 id="guessing-stream-contents"><a href="#guessing-stream-contents"
class="anchor">Guessing stream contents</a></h2>
<p>When all other methods fail, you might need to understand a little
more how liquidsoap guesses what stream contents should be used for each
source.</p>
<p>First, liquidsoap guesses as much as possible (without making
unnecessary assumption) from what’s been given in the script. Usually,
the outputs pretty much determine what sources should contain. A
critical ingredient here is often the <a
href="encoding_formats.html">encoding format</a>. For example, in</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">output.icecast</span>(<span class="ot">%vorbis</span>,<span class="va">mount</span>=<span class="st">&quot;some.ogg&quot;</span>,s)</span></code></pre></div>
<p><code>%vorbis</code> has type <code>format(audio=pcm(stereo))</code>,
hence <code>s</code> should have type
<code>source(audio=pcm(stereo))</code>. This works in more complex
examples, when the types are guessed successively for several
intermediate operators.</p>
<p>After this first phase, it is possible that some contents are still
undetermined. For example in <code>output.alsa(input.alsa())</code>, any
number of audio channels could work, and nothing helps us determine what
is intended. At this point, the default numbers of channels are used.
They are given by the setting
<code>frame.audio/video/midi.channels</code> (whose defaults are
respectively <code>2</code>, <code>0</code> and <code>0</code>). In our
example, stereo audio would be chosen.</p>
          <div id="footer"></div>
        </main>
      </div>
    </div>
    <!--   Core JS Files   -->

    <script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/assets/js/liq-jquery.js" type="text/javascript"></script>
  </body>

</html>
