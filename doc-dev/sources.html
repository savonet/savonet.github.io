<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Liquidsoap</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!-- Extra details for Live View on GitHub Pages -->
    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.liquidsoap.info/" />
    <!--  Social tags      -->
    <meta name="keywords" content="radio, audio, video, streaming, icecast, shoutcast">
    <meta name="description" content="Swiss-army knife for multimedia streaming">
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Liquidsoap Streaming Language">
    <meta itemprop="description" content="Swiss-army knife for multimedia streaming">
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@LiquidsoapMedia">
    <meta name="twitter:title" content="Liquidsoap Streaming Language">
    <meta name="twitter:description" content="Swiss-army knife for multimedia streaming">
    <meta name="twitter:creator" content="@LiquidsoapMedia">
    <meta name="twitter:image" content="https://www.liquidsoap.info//assets/img/bottle_invert.png">
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="/assets/css/custom.css" rel="stylesheet" />
    <link href="/assets/css/material-kit.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <!-- Documentation extras -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="/assets/demo/docs.min.css">
    <style>
    .navbar-absolute-logo {
      padding-left: 45px;
    }

    .navbar-absolute-logo img {
      position: absolute;
      left: 15px;
      margin-top: -6px;
    }

    body {
      background: white;
    }

    p {
        font-size: 16px;
        text-align: justify;
    }
    </style>
    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  </head>

  <body class="bd-docs" data-spy="scroll" data-target=".bd-sidenav-active">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <header class="navbar navbar-expand navbar-dark bg-primary flex-column flex-md-row bd-navbar">
      <a class="navbar-brand mr-0 mr-md-2 navbar-absolute-logo" href="/doc-dev">
        <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 600 600" focusable="false" style="width: 25px; height: 25px;">
          <title>Liquidsoap</title>
          <style type="text/css">
.st0{fill:#FFFFFF;}
          </style>
          <g>
          <path class="st0" d="M102.4,593.8c-0.7-2.8-3.4-2.5-5.3-3.3c-24.6-10.2-37.2-28.7-37.2-55.6c-0.1-72.1,0-144.2,0-216.3
          c0-52.3,0-104.6,0-156.9c0-37.6,23.1-60.9,60.6-61.1c12-0.1,23.9-0.2,35.9,0c15.7,0.3,26.7,10.1,26.3,23
          c-0.4,12.5-11.1,21.5-26.3,21.8c-12,0.2-23.9-0.1-35.9,0.1c-11.8,0.1-15.6,3.7-15.6,15.3c-0.1,124.4,0,248.8-0.1,373.2
          c0,10.3,4.5,15.1,14.8,15.1c69.1-0.1,138.2,0,207.3-0.1c12.3,0,15.5-3.7,15.5-17.7c0-74.7,0-149.4,0-224.2c0-47.8,0-95.6,0-143.5
          c0-15.2-3-18.1-18.4-18.2c-10.8,0-21.7,0.1-32.5,0c-16-0.2-26.7-9.4-26.6-22.5c0.1-13,10.9-22.1,26.9-22.3
          c13.4-0.2,26.9-0.3,40.3,0.1c30.8,1,54.9,24.5,55,55.2c0.3,127.4,0.3,254.8,0.1,382.2c0,25.5-15.8,45.7-40.2,53.3
          c-1.7,0.5-3.8,0-4.5,2.4C262.3,593.8,182.4,593.8,102.4,593.8z"/>
          <path class="st0" d="M537.4,212.6c-16.8,23-56.5,16.5-68.6-9.5c-8-17.2-12.4-32.7-12-54.5c4.6,4.1,8.3,7.5,12.1,10.7
          c10.3,8.6,21,14,35.5,11.8c12.5-1.9,21.5,6,28.2,16.3c2,3,1.3,7.3,4.8,9.5C537.4,202.2,537.4,207.4,537.4,212.6z"/>
          <path class="st0" d="M200.6,230.4c0-55.3,0-110.5,0-165.8c0-40.7,22.3-62.7,63.2-62.7c50.4,0,100.8,0,151.3,0
          c36.1,0,59.1,21.9,60.4,57.7c0.5,13.1,0.4,26.1,0,39.2c-0.4,15.1-10.1,25.8-22.5,25.7c-12-0.1-21.6-10.1-22.3-24.8
          c-0.6-12.7-0.4-25.4-0.1-38.1c0.2-10.4-4.5-14.9-14.9-14.9c-51.5,0.1-103.1,0-154.6,0.1c-12.7,0-15.5,3.2-15.5,17.5
          c0,105.3,0,210.6,0,316c0,7.8,0.1,15.7,0,23.5c-0.2,17.5-9.4,28.9-23,28.6c-13.5-0.3-21.9-10.9-21.9-28.3
          C200.6,346.2,200.6,288.3,200.6,230.4z"/>
          </g>
        </svg>
        Liquidsoap
      </a>
      <ul class="navbar-nav flex-row d-none d-md-flex">
        <li class="nav-item dropdown">
          <a data-versions="dev 2.1.4 2.2.5 2.3.0 2.3.1 2.3.2
2.3.3" data-version="dev" class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="liq-version" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            dev
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="liq-version" id="liq-versions">
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/savonet/liquidsoap" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false">
              <title>GitHub</title>
              <path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd" />
            </svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://twitter.com/liquidsoapmedia" target="_blank" rel="noopener" aria-label="Twitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false">
              <title>Twitter</title>
              <path d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92" fill="currentColor" />
            </svg>
          </a>
        </li>
      </ul>
      <div class="navbar-nav-scroll ml-md-auto ">
        <ul class="navbar-nav bd-navbar-nav flex-row">
          <!--
            <li class="nav-item">
            <a class="nav-link" href=""> <i class="material-icons">card_membership</i> PRO Services </a>
            </li>
            -->
          <li class="nav-item">
            <script async src="https://cse.google.com/cse.js?cx=24f50f6f088994c53"></script>
            <style>
.cse .gsc-control-cse, .gsc-control-cse {
  background-color: transparent;
  border: none;
  width: 300px;
}
            </style>
            <div class="gcse-search"></div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/savonet/liquidsoap/issues" target="_blank" rel="noopener"><i class="material-icons">star</i> Get Help</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/savonet/liquidsoap" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#9c27b0; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
      </a>
      <style>
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out
}

        @keyframes octocat-wave {
          0%,
          100% {
            transform: rotate(0)
          }
          20%,
          60% {
            transform: rotate(-25deg)
          }
          40%,
          80% {
            transform: rotate(10deg)
          }
        }

        @media (max-width:500px) {
          .github-corner:hover .octo-arm {
            animation: none
          }
          .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out
          }
        }
      </style>
    </header>
    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
          <nav class="collapse bd-links" id="bd-docs-nav">
            <div class="bd-toc-item active">
              <ul class="nav bd-sidenav">
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/doc-dev/install.html">
                    Install
                  </a>
                </li>
                <li>
                  <a href="/doc-dev/migrating.html">
                    Migrating from previous versions
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="#">
                    Starters
                  </a>
                </li>
                <li><a href="/doc-dev/book.html">The book</a></li>
                <li>
                  <a href="/doc-dev/presentations.html">Video Presentations</a>
                </li>
                <li>
                  <a href="/doc-dev/help.html">How to find help</a>
                </li>
                <li>
                  <a href="/doc-dev/faq.html">Frequently Asked Questions</a>
                </li>
                <li><a href="/doc-dev/quick_start.html">Quickstart</a></li>
                <li>
                  <a href="/doc-dev/complete_case.html">Complete case analysis</a>
                </li>
                <li>
                  <a href="/doc-dev/cookbook.html">Cookbook</a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Reference
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-dev/language.html">Script language</a></li>
                <li>
                  <a href="/doc-dev/reference.html">Core API</a></li>
                <li>
                  <a href="/doc-dev/reference-extras.html">Extra API</a></li>
                <li>
                  <a href="/doc-dev/reference-deprecated.html">Deprecated API</a></li>
                <li>
                  <a href="/doc-dev/multitrack.html">Multitrack</a></li>
                <li>
                  <a href="/doc-dev/threads.html">Threads</a></li>
                <li>
                  <a href="/doc-dev/protocols.html">Protocols</a></li>
                <li>
                  <a href="/doc-dev/settings.html">Settings</a></li>
                <li>
                  <a href="/doc-dev/ffmpeg.html">FFmpeg support</a></li>
                <li>
                  <a href="/doc-dev/encoding_formats.html">Encoding formats</a></li>
                <li>
                  <a href="/doc-dev/video.html">Videos streams</a></li>
                <li>
                  <a href="/doc-dev/memory.html">Memory management</a></li>
                <li>
                  <a href="/doc-dev/json.html">JSON import/export</a></li>
                <li>
                  <a href="/doc-dev/xml.html">XML import/export</a></li>
                <li>
                  <a href="/doc-dev/yaml.html">YAML import/export</a></li>
                <li>
                  <a href="/doc-dev/ladspa.html">LADSPA plugins</a></li>
                <li>
                  <a href="/doc-dev/playlist_parsers.html">Playlist parsers</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Core
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-dev/sources.html">Sources</a></li>
                <li>
                  <a href="/doc-dev/clocks.html">Clocks</a></li>
                <li>
                  <a href="/doc-dev/requests.html">Requests</a></li>
                <li>
                  <a href="/doc-dev/protocols-presentation.html">Protocols</a></li>
                <li>
                  <a href="/doc-dev/stream_content.html">Stream contents</a></li>
                <li>
                  <a href="/doc-dev/strings_encoding.html">Strings encoding</a></li>
                <li>
                  <a href="/doc-dev/script_loading.html">Script loading</a></li>
                <li><a href="/doc-dev/phases.html">Execution phases</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Specific tutorials
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-dev/harbor_http.html">Using the HTTP server</a></li>
                <li>
                  <a href="/doc-dev/blank.html">Blank detection</a></li>
                <li>
                  <a href="/doc-dev/metadata.html">Customize metadata</a></li>
                <li>
                  <a href="/doc-dev/seek.html">Seek and cue support</a></li>
                <li>
                  <a href="/doc-dev/external_decoders.html">External decoders</a></li>
                <li>
                  <a href="/doc-dev/external_streams.html">External streams</a></li>
                <li>
                  <a href="/doc-dev/external_encoders.html">External encoders</a></li>
                <li>
                  <a href="/doc-dev/hls_output.html">HLS output</a></li>
                <li>
                  <a href="/doc-dev/http_input.html">HTTP input</a></li>
                <li>
                  <a href="/doc-dev/harbor.html">Harbor input</a></li>
                <li>
                  <a href="/doc-dev/stereotool.html">Stereotool</a></li>
                <li>
                  <a href="/doc-dev/server.html">Using the telnet server</a></li>
                <li>
                  <a href="/doc-dev/icy_metadata.html">ICY metadata update</a></li>
                <li>
                  <a href="/doc-dev/replay_gain.html">Normalization and replay gain</a></li>
                <li>
                  <a href="/doc-dev/request_sources.html">Requests-based sources</a></li>
                <li>
                  <a href="/doc-dev/shoutcast.html">Shoutcast output</a></li>
                <li>
                  <a href="/doc-dev/dynamic_sources.html">Dynamic source creation</a></li>
                <li>
                  <a href="/doc-dev/crossfade.html">Crossfading</a></li>
                <li>
                  <a href="/doc-dev/in_production.html">Using in production</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    User scripts
                  </a>
                </li>
                <li>
                  <a href="/doc-dev/beets.html">Beets</a></li>
                <li>
                  <a href="/doc-dev/geekradio.html">Geekradio</a></li>
                <li>
                  <a href="/doc-dev/radiopi.html">RadioPi</a></li>
                <li>
                  <a href="/doc-dev/dolebrai.html">Dolebraï</a></li>
                <li>
                  <a href="/doc-dev/frequence3.html">Frequence3</a></li>
                <li>
                  <a href="/doc-dev/video-static.html">Video with a single static image</a></li>
                <li>
                  <a href="/doc-dev/split-cue.html">Split a CUE sheet</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    Behind the curtains
                  </a>
                </li>
                <li>
                  <a href="/doc-dev/publications.html">Some presentations and publications</a></li>
                <li>
                  <a href="https://github.com/savonet">OCaml libraries</a></li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/legacy">
                    Legacy website
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <!--
          <div class="d-none d-xl-block col-xl-2 bd-toc">
          <ul class="section-nav">
          <li class="toc-entry toc-h2">
          <a href="#quick-start">Quick start</a>
          <ul>
          <li class="toc-entry toc-h3">
          <a href="#css">CSS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#js">JS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#fonts-and-icons">Fonts and Icons</a>
          </li>
          </ul>
          </li>
          <li class="toc-entry toc-h2">
          <a href="#starter-template">Starter template</a>
          </li>
          </ul>
          </div>
        -->
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
          <h1 id="sources"><a href="#sources"
class="anchor">Sources</a></h1>
<p>Using liquidsoap is about writing a script describing how to build
what you want. It is about building a stream using elementary streams
and stream combinators, etc. Actually, it’s a bit more than streams, we
call them <em>sources</em>.</p>
<p>A source is a stream with metadata and track annotations. It is
discretized as a stream of fixed-length buffers of media samples, the
frames. Every frame may have metadata inserted at any point,
independently of track boundaries. At every instant, a source can be
asked to fill a frame of data.</p>
<p>The liquidsoap API provides plenty of functions for building sources.
Some of those functions build elementary sources from scratch, others
are operators that combine sources into more complex ones. An important
class of sources is that of <em>active sources</em>, they are the
sources that actively trigger the computation of your stream. Typically,
active sources are built from output functions, because outputting a
stream is the only reason why you want to compute it.</p>
<p>All sources, operators and outputs are listed in the <a
href="reference.html">scripting API reference</a>.</p>
<h2 id="how-does-it-work"><a href="#how-does-it-work" class="anchor">How
does it work?</a></h2>
<p>To clarify the picture let’s study in more details an example:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">radio</span> =</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">output.icecast</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="ot">%vorbis</span>,<span class="va">mount</span>=<span class="st">&quot;test.ogg&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">random</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      [ jingle ,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fallback</span>([ playlist1,playlist2,playlist3 ]) ]))</span></code></pre></div>
<p>At every cycle of the <a href="clocks.html">clock</a>, the output
asks the <code>random</code> node for data, until it gets a full frame
of raw audio. Then, it encodes the frame and sends it to the Icecast
server. Suppose <code>random</code> has chosen the <code>fallback</code>
node, and that only <code>playlist2</code> is available, and thus
played. At every cycle, the buffer is passed from <code>random</code> to
<code>fallback</code> and then to <code>playlist2</code> which fills it,
returns it to <code>fallback</code> which returns it to
<code>random</code> which returns it to the output.</p>
<p>At some point, <code>playlist2</code> ends a track. The fallback
detects that on the returned buffer, and selects a new child for the
next filling, depending on who’s available. But it doesn’t change the
buffer, and returns it to <code>random</code>, which also (randomly)
selects a new child at this point, before returning the buffer to the
output. On next filling, the route of the frame can be different.</p>
<p>Note that it is also possible to have the route changed inside a
track, for example using the <code>track_sensitive</code> option of
fallback, which is typically done for instant switches to live shows
when they start.</p>
<p>The important point here is that <strong>all of the above steps are
local</strong>. Everything takes place between one operator and its
immediate children source; operators do not see beyond that point.</p>
<h2 id="fallibility"><a href="#fallibility"
class="anchor">Fallibility</a></h2>
<p>By default, liquidsoap outputs are meant to emit a stream without
discontinuing. Since this stream is provided by the source passed to the
output operator, it is the source responsibility to never fail.
Liquidsoap has a mechanism to verify this, which helps you think of all
possible failures, and prevent them. Elementary sources are either
<em>fallible</em> or <em>infallible</em>, and this <em>liveness
type</em> is propagated through operators to finally compute the type of
any source. For example, a <code>fallback</code> or <code>random</code>
source is infallible if an only if at least one of its children is
infallible, and a <code>switch</code> is infallible if and only if it
has one infallible child guarded by the trivial predicate
<code>{ true }</code>.</p>
<p>On startup, each output checks the liveness type of its input source,
and issues an error if it is fallible. The typical fix for such problems
is to add one fallback to play a default file (<code>single()</code>) or
a checked playlist (<code>playlist.safe()</code>) if the normal source
fails. One can also use the <code>mksafe</code> operator that will
insert silence during failures.</p>
<p>If you do not care about failures, you can pass the parameter
<code>fallible=true</code> to most outputs. In that case, the output
will accept a fallible source, and stop whenever the source fails, to
restart when it is ready to emit a stream again.</p>
<h2 id="caching-mode"><a href="#caching-mode" class="anchor">Caching
mode</a></h2>
<p>In some situations, a source must take care of the consistency of its
output. If it is asked twice to fill buffers during the same cycle, it
should fill them with the same data. Suppose for example that a playlist
is used by two outputs, and that it gives the first frame to the first
output, the second frame to the second output: it would give the third
frame to the first output during the second cycle, and the output will
have missed one frame.</p>
<p>It is sometimes useful to keep this is mind to understand the
behaviour of some complex scripts. The high-level picture is enough for
users, more details follow for developers and curious readers.</p>
<p>The sources detect if they need to remember (cache) their previous
output in order to replay it. To do that, clients of the source must
register in advance. If two clients have registered, then caching should
be enabled. Actually that’s a bit more complicated, because of
transitions. Obviously the sources which use a transition involving some
other source must register to it, because they may eventually use it.
But a jingle used in two transitions by the same switching operator
doesn’t need caching. The solution involves two kinds of registering:
<em>dynamic</em> and <em>static activations</em>. Activations are
associated with a path in the graph of sources’ nesting. The dynamic
activation is a pre-registration allowing a single real <em>static
activation</em> to come later, possibly in the middle of a cycle. Two
static activations trigger caching. The other reason for enabling
caching is when there is one static activation and one dynamic
activation which doesn’t come from a prefix of the static activation’s
path. It means that the dynamic activation can yield at any moment to a
static activation and that the source will be used by two sources at the
same time.</p>
<h2 id="execution-model"><a href="#execution-model"
class="anchor">Execution model</a></h2>
<p>In your script you define a bunch of sources interacting together.
Each source belongs to a <a href="clocks.html">clock</a>, but clocks
only have direct access to <em>active sources</em>, which are mostly
outputs. At every cycle of the clock, active sources are animated: a
chunk of stream (frame) is computed, and potentially outputted one way
or another.</p>
<p>This streaming task is the most important and shouldn’t be disturbed.
Thus, other tasks are done in auxiliary threads: file download, audio
validity checking, http polling, playlist reloading… No blocking or
expensive call should be done in streaming threads. Remote files are
completely downloaded to a local temporary file before use by the root
thread. It also means that you shouldn’t access NFS or any kind of
falsely local files.</p>
          <div id="footer"></div>
        </main>
      </div>
    </div>
    <!--   Core JS Files   -->

    <script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/assets/js/liq-jquery.js" type="text/javascript"></script>
  </body>

</html>
