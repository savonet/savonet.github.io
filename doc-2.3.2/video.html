<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Liquidsoap</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!-- Extra details for Live View on GitHub Pages -->
    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.liquidsoap.info/" />
    <!--  Social tags      -->
    <meta name="keywords" content="radio, audio, video, streaming, icecast, shoutcast">
    <meta name="description" content="Swiss-army knife for multimedia streaming">
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Liquidsoap Streaming Language">
    <meta itemprop="description" content="Swiss-army knife for multimedia streaming">
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@LiquidsoapMedia">
    <meta name="twitter:title" content="Liquidsoap Streaming Language">
    <meta name="twitter:description" content="Swiss-army knife for multimedia streaming">
    <meta name="twitter:creator" content="@LiquidsoapMedia">
    <meta name="twitter:image" content="https://www.liquidsoap.info//assets/img/bottle_invert.png">
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="/assets/css/custom.css" rel="stylesheet" />
    <link href="/assets/css/material-kit.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <!-- Documentation extras -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="/assets/demo/docs.min.css">
    <style>
    .navbar-absolute-logo {
      padding-left: 45px;
    }

    .navbar-absolute-logo img {
      position: absolute;
      left: 15px;
      margin-top: -6px;
    }

    body {
      background: white;
    }

    p {
        font-size: 16px;
        text-align: justify;
    }
    </style>
    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  
  </head>

  <body class="bd-docs" data-spy="scroll" data-target=".bd-sidenav-active">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <header class="navbar navbar-expand navbar-dark bg-primary flex-column flex-md-row bd-navbar">
      <a class="navbar-brand mr-0 mr-md-2 navbar-absolute-logo" href="/doc-2.3.2">
        <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 600 600" focusable="false" style="width: 25px; height: 25px;">
          <title>Liquidsoap</title>
          <style type="text/css">
.st0{fill:#FFFFFF;}
          </style>
          <g>
          <path class="st0" d="M102.4,593.8c-0.7-2.8-3.4-2.5-5.3-3.3c-24.6-10.2-37.2-28.7-37.2-55.6c-0.1-72.1,0-144.2,0-216.3
          c0-52.3,0-104.6,0-156.9c0-37.6,23.1-60.9,60.6-61.1c12-0.1,23.9-0.2,35.9,0c15.7,0.3,26.7,10.1,26.3,23
          c-0.4,12.5-11.1,21.5-26.3,21.8c-12,0.2-23.9-0.1-35.9,0.1c-11.8,0.1-15.6,3.7-15.6,15.3c-0.1,124.4,0,248.8-0.1,373.2
          c0,10.3,4.5,15.1,14.8,15.1c69.1-0.1,138.2,0,207.3-0.1c12.3,0,15.5-3.7,15.5-17.7c0-74.7,0-149.4,0-224.2c0-47.8,0-95.6,0-143.5
          c0-15.2-3-18.1-18.4-18.2c-10.8,0-21.7,0.1-32.5,0c-16-0.2-26.7-9.4-26.6-22.5c0.1-13,10.9-22.1,26.9-22.3
          c13.4-0.2,26.9-0.3,40.3,0.1c30.8,1,54.9,24.5,55,55.2c0.3,127.4,0.3,254.8,0.1,382.2c0,25.5-15.8,45.7-40.2,53.3
          c-1.7,0.5-3.8,0-4.5,2.4C262.3,593.8,182.4,593.8,102.4,593.8z"/>
          <path class="st0" d="M537.4,212.6c-16.8,23-56.5,16.5-68.6-9.5c-8-17.2-12.4-32.7-12-54.5c4.6,4.1,8.3,7.5,12.1,10.7
          c10.3,8.6,21,14,35.5,11.8c12.5-1.9,21.5,6,28.2,16.3c2,3,1.3,7.3,4.8,9.5C537.4,202.2,537.4,207.4,537.4,212.6z"/>
          <path class="st0" d="M200.6,230.4c0-55.3,0-110.5,0-165.8c0-40.7,22.3-62.7,63.2-62.7c50.4,0,100.8,0,151.3,0
          c36.1,0,59.1,21.9,60.4,57.7c0.5,13.1,0.4,26.1,0,39.2c-0.4,15.1-10.1,25.8-22.5,25.7c-12-0.1-21.6-10.1-22.3-24.8
          c-0.6-12.7-0.4-25.4-0.1-38.1c0.2-10.4-4.5-14.9-14.9-14.9c-51.5,0.1-103.1,0-154.6,0.1c-12.7,0-15.5,3.2-15.5,17.5
          c0,105.3,0,210.6,0,316c0,7.8,0.1,15.7,0,23.5c-0.2,17.5-9.4,28.9-23,28.6c-13.5-0.3-21.9-10.9-21.9-28.3
          C200.6,346.2,200.6,288.3,200.6,230.4z"/>
          </g>
        </svg>
        Liquidsoap
      </a>
      <ul class="navbar-nav flex-row d-none d-md-flex">
        <li class="nav-item dropdown">
          <a data-versions="dev 2.1.4 2.2.5 2.3.0 2.3.1 2.3.2
2.3.3" data-version="2.3.2" class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="liq-version" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            2.3.2
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="liq-version" id="liq-versions">
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/savonet/liquidsoap" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false">
              <title>GitHub</title>
              <path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd" />
            </svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://twitter.com/liquidsoapmedia" target="_blank" rel="noopener" aria-label="Twitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false">
              <title>Twitter</title>
              <path d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92" fill="currentColor" />
            </svg>
          </a>
        </li>
      </ul>
      <div class="navbar-nav-scroll ml-md-auto ">
        <ul class="navbar-nav bd-navbar-nav flex-row">
          <!--
            <li class="nav-item">
            <a class="nav-link" href=""> <i class="material-icons">card_membership</i> PRO Services </a>
            </li>
            -->
          <li class="nav-item">
            <script async src="https://cse.google.com/cse.js?cx=24f50f6f088994c53"></script>
            <style>
.cse .gsc-control-cse, .gsc-control-cse {
  background-color: transparent;
  border: none;
  width: 300px;
}
            </style>
            <div class="gcse-search"></div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/savonet/liquidsoap/issues" target="_blank" rel="noopener"><i class="material-icons">star</i> Get Help</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/savonet/liquidsoap" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#9c27b0; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
      </a>
      <style>
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out
}

        @keyframes octocat-wave {
          0%,
          100% {
            transform: rotate(0)
          }
          20%,
          60% {
            transform: rotate(-25deg)
          }
          40%,
          80% {
            transform: rotate(10deg)
          }
        }

        @media (max-width:500px) {
          .github-corner:hover .octo-arm {
            animation: none
          }
          .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out
          }
        }
      </style>
    </header>
    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
          <nav class="collapse bd-links" id="bd-docs-nav">
            <div class="bd-toc-item active">
              <ul class="nav bd-sidenav">
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/doc-2.3.2/install.html">
                    Install
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.2/migrating.html">
                    Migrating from previous versions
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="#">
                    Starters
                  </a>
                </li>
                <li><a href="/doc-2.3.2/book.html">The book</a></li>
                <li>
                  <a href="/doc-2.3.2/presentations.html">Video Presentations</a>
                </li>
                <li>
                  <a href="/doc-2.3.2/help.html">How to find help</a>
                </li>
                <li>
                  <a href="/doc-2.3.2/faq.html">Frequently Asked Questions</a>
                </li>
                <li><a href="/doc-2.3.2/quick_start.html">Quickstart</a></li>
                <li>
                  <a href="/doc-2.3.2/complete_case.html">Complete case analysis</a>
                </li>
                <li>
                  <a href="/doc-2.3.2/cookbook.html">Cookbook</a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Reference
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.2/language.html">Script language</a></li>
                <li>
                  <a href="/doc-2.3.2/reference.html">Core API</a></li>
                <li>
                  <a href="/doc-2.3.2/reference-extras.html">Extra API</a></li>
                <li>
                  <a href="/doc-2.3.2/reference-deprecated.html">Deprecated API</a></li>
                <li>
                  <a href="/doc-2.3.2/multitrack.html">Multitrack</a></li>
                <li>
                  <a href="/doc-2.3.2/threads.html">Threads</a></li>
                <li>
                  <a href="/doc-2.3.2/protocols.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.3.2/settings.html">Settings</a></li>
                <li>
                  <a href="/doc-2.3.2/ffmpeg.html">FFmpeg support</a></li>
                <li>
                  <a href="/doc-2.3.2/encoding_formats.html">Encoding formats</a></li>
                <li>
                  <a href="/doc-2.3.2/video.html">Videos streams</a></li>
                <li>
                  <a href="/doc-2.3.2/memory.html">Memory management</a></li>
                <li>
                  <a href="/doc-2.3.2/json.html">JSON import/export</a></li>
                <li>
                  <a href="/doc-2.3.2/xml.html">XML import/export</a></li>
                <li>
                  <a href="/doc-2.3.2/yaml.html">YAML import/export</a></li>
                <li>
                  <a href="/doc-2.3.2/ladspa.html">LADSPA plugins</a></li>
                <li>
                  <a href="/doc-2.3.2/playlist_parsers.html">Playlist parsers</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Core
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.2/sources.html">Sources</a></li>
                <li>
                  <a href="/doc-2.3.2/clocks.html">Clocks</a></li>
                <li>
                  <a href="/doc-2.3.2/requests.html">Requests</a></li>
                <li>
                  <a href="/doc-2.3.2/protocols-presentation.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.3.2/stream_content.html">Stream contents</a></li>
                <li>
                  <a href="/doc-2.3.2/strings_encoding.html">Strings encoding</a></li>
                <li>
                  <a href="/doc-2.3.2/script_loading.html">Script loading</a></li>
                <li><a href="/doc-2.3.2/phases.html">Execution phases</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Specific tutorials
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.2/harbor_http.html">Using the HTTP server</a></li>
                <li>
                  <a href="/doc-2.3.2/blank.html">Blank detection</a></li>
                <li>
                  <a href="/doc-2.3.2/metadata.html">Customize metadata</a></li>
                <li>
                  <a href="/doc-2.3.2/seek.html">Seek and cue support</a></li>
                <li>
                  <a href="/doc-2.3.2/external_decoders.html">External decoders</a></li>
                <li>
                  <a href="/doc-2.3.2/external_streams.html">External streams</a></li>
                <li>
                  <a href="/doc-2.3.2/external_encoders.html">External encoders</a></li>
                <li>
                  <a href="/doc-2.3.2/hls_output.html">HLS output</a></li>
                <li>
                  <a href="/doc-2.3.2/http_input.html">HTTP input</a></li>
                <li>
                  <a href="/doc-2.3.2/harbor.html">Harbor input</a></li>
                <li>
                  <a href="/doc-2.3.2/stereotool.html">Stereotool</a></li>
                <li>
                  <a href="/doc-2.3.2/server.html">Using the telnet server</a></li>
                <li>
                  <a href="/doc-2.3.2/icy_metadata.html">ICY metadata update</a></li>
                <li>
                  <a href="/doc-2.3.2/replay_gain.html">Normalization and replay gain</a></li>
                <li>
                  <a href="/doc-2.3.2/request_sources.html">Requests-based sources</a></li>
                <li>
                  <a href="/doc-2.3.2/shoutcast.html">Shoutcast output</a></li>
                <li>
                  <a href="/doc-2.3.2/dynamic_sources.html">Dynamic source creation</a></li>
                <li>
                  <a href="/doc-2.3.2/crossfade.html">Crossfading</a></li>
                <li>
                  <a href="/doc-2.3.2/in_production.html">Using in production</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    User scripts
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.2/beets.html">Beets</a></li>
                <li>
                  <a href="/doc-2.3.2/geekradio.html">Geekradio</a></li>
                <li>
                  <a href="/doc-2.3.2/radiopi.html">RadioPi</a></li>
                <li>
                  <a href="/doc-2.3.2/dolebrai.html">Dolebraï</a></li>
                <li>
                  <a href="/doc-2.3.2/frequence3.html">Frequence3</a></li>
                <li>
                  <a href="/doc-2.3.2/video-static.html">Video with a single static image</a></li>
                <li>
                  <a href="/doc-2.3.2/split-cue.html">Split a CUE sheet</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    Behind the curtains
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.2/publications.html">Some presentations and publications</a></li>
                <li>
                  <a href="https://github.com/savonet">OCaml libraries</a></li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/legacy">
                    Legacy website
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <!--
          <div class="d-none d-xl-block col-xl-2 bd-toc">
          <ul class="section-nav">
          <li class="toc-entry toc-h2">
          <a href="#quick-start">Quick start</a>
          <ul>
          <li class="toc-entry toc-h3">
          <a href="#css">CSS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#js">JS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#fonts-and-icons">Fonts and Icons</a>
          </li>
          </ul>
          </li>
          <li class="toc-entry toc-h2">
          <a href="#starter-template">Starter template</a>
          </li>
          </ul>
          </div>
        -->
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
          <p>Basically streaming videos does not change anything
compared to streaming audio: you just have to use video files instead of
sound files! For instance, if you want to stream a single file to an
icecast server in ogg format (with theora and vorbis as codecs for audio
and video) you can simply type:</p>
<div class="sourceCode" id="cb1" data-include="video-simple.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">single</span>(<span class="st">&quot;video.mp4&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">output.icecast</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="ot">%ffmpeg</span>(<span class="va">format</span>=<span class="st">&quot;ogg&quot;</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>          <span class="ot">%audio</span>(<span class="va">codec</span>=<span class="st">&quot;libvorbis&quot;</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>          <span class="ot">%video</span>(<span class="va">codec</span>=<span class="st">&quot;libtheora&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">host</span>=<span class="st">&quot;localhost&quot;</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">port</span>=<span class="dv">8000</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">password</span>=<span class="st">&quot;hackme&quot;</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">mount</span>=<span class="st">&quot;/videostream&quot;</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        s)</span></code></pre></div>
<p>And of course you could have used a <code>playlist</code> instead of
<code>single</code> to have multiple files, or used other <a
href="encoding_formats.html">formats</a> for the stream.</p>
<p>In order to test a video stream, it is often convenient to use the
<code>output.sdl</code> operator (or <code>output.graphics</code>) which
will open a window and display the video stream inside. These can handle
streams with video only, you can use the <code>drop_audio</code>
operator to remove the sound part of a stream if needed.</p>
<p>You should be expecting much higher resource needs (in cpu time in
particular) for video than for audio. So, be prepared to hear the fan of
your computer! The size of videos have a great impact on computations;
if your machine cannot handle a stream (i.e. it’s always catching up)
you can try to encode to smaller videos for a start.</p>
<h3 id="setting-up-frame-size-and-positions"><a
href="#setting-up-frame-size-and-positions" class="anchor">Setting up
frame size and positions</a></h3>
<p>We provide an abstract API to specify video frame sizes and positions
that is independent from the actual rendered size. This way, you can
define all your elements and have them being rendered at different frame
size without having to change their placement or size values!</p>
<p>This works by setting up a <em>virtual canvas</em> that is larger
than the <em>actual canvas</em>. You specify your positions, sizes etc.
in terms of units for the larger canvas and they are translated
automatically to values that apply for the actual canvas.</p>
<p>We provide some default values. They are all <code>16:9</code> ratio
using a virtual canvas of <code>10 000</code> pixels height:</p>
<div class="sourceCode" id="cb2"
data-include="video-default-canvas.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard video canvas based off a `10k` virtual canvas.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># @category Source / Video processing</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="va">video.canvas.virtual_10k</span> =</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="dt">make</span>(width, height) =</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">video.canvas.make</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      <span class="va">virtual_width</span>=<span class="dv">10000</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      <span class="va">actual_size</span>={<span class="va">width</span>=width, <span class="va">height</span>=height},</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="va">font_size</span>=<span class="dv">160</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">end</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">actual_360p</span>=<span class="dt">make</span>(<span class="dv">640</span>, <span class="dv">360</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="va">actual_480p</span>=<span class="dt">make</span>(<span class="dv">640</span>, <span class="dv">480</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">actual_720p</span>=<span class="dt">make</span>(<span class="dv">1280</span>, <span class="dv">720</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="va">actual_1080p</span>=<span class="dt">make</span>(<span class="dv">1920</span>, <span class="dv">1080</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">actual_1440p</span>=<span class="dt">make</span>(<span class="dv">2560</span>, <span class="dv">1440</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="va">actual_4k</span>=<span class="dt">make</span>(<span class="dv">3840</span>, <span class="dv">2160</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="va">actual_8k</span>=<span class="dt">make</span>(<span class="dv">7680</span>, <span class="dv">4320</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>The returned canvas is a record with the following methods:</p>
<ul>
<li><code>width</code>/<code>height</code>: size of the actual
frame</li>
<li><code>px</code>: define values in terms of virtual pixels</li>
<li><code>vw</code>/<code>vh</code>: define values in terms of
percentage (between <code>0.</code> and <code>1.</code>) of, resp., the
actual frame width and height</li>
<li><code>rem</code>: define values in terms of percentage (between
<code>0.</code> and <code>1.</code>) of the default font size</li>
</ul>
<p>All the positioning methods are functions. For convenience, you can
use the infix operator <code>@</code> to make things more readable. For
instance, instead of writing <code>px(120)</code> to define a size of
<code>120px</code>, you can write: <code>120 @ px</code>. These two
notations are equivalent but the second one is more readable in this
context.</p>
<p>Here’s an example of how to use this:</p>
<div class="sourceCode" id="cb3"
data-include="video-canvas-example.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">background</span> = <span class="dt">blank</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># BEGIN</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Change to video.canvas.virtual_10k.actual_720p etc.. to render</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># in different sizes without changing the values below!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> {px, rem, vh, vw, width, height} = video.canvas.virtual_10k.actual_1080p</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>video.frame.width := width</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>video.frame.height := height</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="va">background</span> =</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">video.add_image</span>(</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">x</span>=<span class="fl">0.3</span> @ vw,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="va">y</span>=<span class="fl">0.01</span> @ vh,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">width</span>=<span class="dv">1562</span> @ px,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="va">height</span>=<span class="dv">1562</span> @ px,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">file</span>=<span class="st">&quot;/path/to/cover.jpg&quot;</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    background</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="va">background</span> =</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">video.add_text</span>(</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="va">color</span>=<span class="dv">0</span>xFCB900,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">speed</span>=<span class="dv">0</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="va">x</span>=<span class="dv">234</span> @ px,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="va">y</span>=<span class="dv">4437</span> @ px,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="va">size</span>=<span class="fl">1.5</span> @ rem,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Some text&quot;</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    background</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co"># END</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="dt">output.dummy</span>(<span class="va">fallible</span>=<span class="dv">true</span>, background)</span></code></pre></div>
<h3 id="encoding-with-ffmpeg"><a href="#encoding-with-ffmpeg"
class="anchor">Encoding with FFmpeg</a></h3>
<p>The <code>%ffmpeg</code> encoder is the recommended encoder when
working with video. Not only does it support a wide range of audio and
video formats but it can also send and receive data to many different
places, using <code>input.ffmpeg.</code> and <code>output.url</code>. On
top of that, it also supports all the <a
href="https://ffmpeg.org/ffmpeg-filters.html">FFmpeg filters</a> and
passing encoded data, if your script does not need re-encoding.</p>
<p>The syntax for the encoder is detailed in the <a
href="encoding_formats.html">encoders page</a>. Here are some
examples:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AC3 audio and H264 video encapsulated in a MPEG-TS bitstream</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ot">%ffmpeg(format=&quot;mpegts&quot;,</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%audio</span>(<span class="va">codec</span>=<span class="st">&quot;ac3&quot;</span>,<span class="va">channel_coupling</span>=<span class="dv">0</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%video</span>(<span class="va">codec</span>=<span class="st">&quot;libx264&quot;</span>,<span class="va">b</span>=<span class="st">&quot;2600k&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;x264-params&quot;</span>=<span class="st">&quot;scenecut=0:open_gop=0:min-keyint=150:keyint=150&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="va">preset</span>=<span class="st">&quot;ultrafast&quot;</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># AAC audio and H264 video encapsulated in a mp4 file (to use with</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># `output.file` only, mp4 container cannot be streamed!</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="ot">%ffmpeg(format=&quot;mp4&quot;,</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%audio</span>(<span class="va">codec</span>=<span class="st">&quot;aac&quot;</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%video</span>(<span class="va">codec</span>=<span class="st">&quot;libx264&quot;</span>,<span class="va">b</span>=<span class="st">&quot;2600k&quot;</span>))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ogg opus and theora encappsulated in an ogg bitstream</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="ot">%ffmpeg(format=&quot;ogg&quot;,</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%audio</span>(<span class="va">codec</span>=<span class="st">&quot;libopus&quot;</span>),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%video</span>(<span class="va">codec</span>=<span class="st">&quot;libtheora&quot;</span>))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Ogg opus and VP8 video encapsulated in a webm bitstream</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="ot">%ffmpeg(format=&quot;webm&quot;,</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%audio</span>(<span class="va">codec</span>=<span class="st">&quot;libopus&quot;</span>),</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">%video</span>(<span class="va">codec</span>=<span class="st">&quot;libvpx&quot;</span>))</span></code></pre></div>
<h3 id="streaming-with-ffmpeg"><a href="#streaming-with-ffmpeg"
class="anchor">Streaming with FFmpeg</a></h3>
<p>The main input to take advantage of FFmpeg is
<code>input.ffmpeg</code>. It should be able to decode pretty much any
url and file that the <code>ffmpeg</code> command-line can take as
input. This is, in particular, how <code>input.rtmp</code> is
defined.</p>
<p>For outputting, one can use the regular outputs but some of them have
special features when used with <code>%ffmpeg</code>:</p>
<ul>
<li><code>output.file</code> is able to properly close a file after it
is done encoding it. This makes it possible to encode in formats that
need a proper header after encoding is done, such as
<code>mp4</code>.</li>
<li><code>output.url</code> will only work with the <code>%ffmpeg</code>
encoder. It delegates data output to FFmpeg and can support any url that
the <code>ffmpeg</code> command-line supports.</li>
<li><code>output.file.hls</code> and <code>output.harbor.hls</code>
should only be used with <code>%ffmpeg</code>. The other encoders do
work but <code>%ffmpeg</code> is the only encoder able to generate valid
<code>MPEG-TS</code> and <code>MP4</code> data segments for the HLS
specifications.</li>
</ul>
<h2 id="useful-tips-tricks"><a href="#useful-tips-tricks"
class="anchor">Useful tips &amp; tricks</a></h2>
<p>Video is a really exciting world where there are lots of cool stuff
to do.</p>
<h3 id="transitions"><a href="#transitions"
class="anchor">Transitions</a></h3>
<p>Transitions at the beginning or at the end of video can be achieved
using <code>video.fade.in</code> and <code>video.fade.out</code>. For
instance, fading at the beginning of videos is done by</p>
<div class="sourceCode" id="cb5" data-include="video-transition.liq"
data-from="BEGIN" data-to="END"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">video.fade.in</span>(<span class="va">transition</span>=<span class="st">&quot;fade&quot;</span>, <span class="va">duration</span>=<span class="fl">3.</span>, s)</span></code></pre></div>
<h3 id="adding-a-logo"><a href="#adding-a-logo" class="anchor">Adding a
logo</a></h3>
<p>You can add a logo (any image) using the <code>video.add_image</code>
operator, as follows:</p>
<div class="sourceCode" id="cb6" data-include="video-logo.liq"
data-from="BEGIN" data-to="END"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">video.add_image</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>       <span class="va">width</span>=<span class="dv">30</span>,<span class="va">height</span>=<span class="dv">30</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>       <span class="va">x</span>=<span class="dv">10</span>,<span class="va">y</span>=<span class="dv">10</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>       <span class="va">file</span>=<span class="st">&quot;logo.jpg&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>       s)</span></code></pre></div>
<h3 id="inputting-from-a-webcam"><a href="#inputting-from-a-webcam"
class="anchor">Inputting from a webcam</a></h3>
<p>If your computer has a webcam, it can be used as a source thanks to
the <code>input.v4l2</code> operator. For instance:</p>
<div class="sourceCode" id="cb7" data-include="video-webcam.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dt">output.sdl</span>(<span class="dt">input.v4l2</span>())</span></code></pre></div>
<h3 id="video-in-video"><a href="#video-in-video" class="anchor">Video
in video</a></h3>
<p>Suppose that you have two video sources <code>s</code> and
<code>s2</code> and you want to display a small copy of <code>s2</code>
on top of <code>s</code>. This can be achieved by</p>
<div class="sourceCode" id="cb8" data-include="video-in-video.liq"
data-from="BEGIN" data-to="END"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">s2</span> = <span class="dt">video.scale</span>(<span class="va">scale</span>=<span class="fl">0.2</span>, <span class="va">x</span>=<span class="dv">10</span>, <span class="va">y</span>=<span class="dv">10</span>, s2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">add</span>([s, s2])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<h3 id="scrolling-text"><a href="#scrolling-text"
class="anchor">Scrolling text</a></h3>
<p>Adding scrolling text at the bottom of your video is as easy as</p>
<div class="sourceCode" id="cb9" data-include="video-text.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">blank</span>()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">video.add_text.sdl</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>       <span class="va">font</span>=<span class="st">&quot;/usr/share/fonts/truetype/ttf-dejavu/DejaVuSans.ttf&quot;</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;Hello world!&quot;</span>, s)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="dt">output.dummy</span>(<span class="va">fallible</span>=<span class="dv">true</span>, s)</span></code></pre></div>
<p>You might need to change the <code>font</code> parameter so that it
matches a font file present on your system.</p>
<h3 id="effects"><a href="#effects" class="anchor">Effects</a></h3>
<p>There are many of effects that you can use to add some fun to your
videos: <code>video.greyscale</code>, <code>video.sepia</code>,
<code>video.lomo</code>, etc. <a href="reference.html">Read the
documentation</a> to find out about them. If you have compiled
Liquidsoap with <a href="http://www.piksel.org/frei0r/">frei0r</a>
support, and have installed frei0r plugins, they will be named
<code>video.frei0r.*</code>. You can have a list of those supported on
your installation as usual, using
<code>liquidsoap --list-plugins</code>.</p>
<h3 id="presenting-weather-forecast"><a
href="#presenting-weather-forecast" class="anchor">Presenting weather
forecast</a></h3>
<p>You can say that a specific color should be transparent using
<code>video.transparent</code>. For instance, you can put yourself in
front of a blue screen (whose RGB color should be around 0x0000ff) and
replace the blue screen by an image of the weather using</p>
<div class="sourceCode" id="cb10" data-include="video-weather.liq"
data-to="END"><pre class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="va">img</span> = <span class="dt">single</span>(<span class="st">&quot;weather.jpg&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="va">cam</span> = <span class="dt">input.v4l2</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="va">cam</span> = <span class="dt">video.alpha.of_color</span>(<span class="va">color</span>=<span class="bn">0x0000ff</span>, <span class="va">precision</span>=<span class="fl">0.2</span>, cam)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">add</span>([img, cam])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<h2 id="detailed-examples"><a href="#detailed-examples"
class="anchor">Detailed examples</a></h2>
<h3 id="the-anonymizer"><a href="#the-anonymizer" class="anchor">The
anonymizer</a></h3>
<p>Let’s design an ``anonymizer’’ effect: I want to blur my face and
change my voice so that nobody will recognise me in the street after
seeing the youtube video. Here is what we are going to achieve:</p>
<center>
<iframe width="560" height="315" src="//www.youtube.com/embed/E7Fb0wV3h5Q" frameborder="0" allowfullscreen>
</iframe>
</center>
<p>This video was produced thanks to the following script:</p>
<div class="sourceCode" id="cb11"
data-include="video-anonymizer.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Input from webcam</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="va">cam</span> = <span class="dt">input.v4l2</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect faces (this generates a white disk over faces)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="va">mask</span> = <span class="dt">video.frei0r.opencvfacedetect</span>(cam)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pixellize the video</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="va">censored</span> = <span class="dt">video.frei0r.pixeliz0r</span>(<span class="va">block_width</span>=<span class="fl">0.1</span>, <span class="va">block_height</span>=<span class="fl">0.1</span>, cam)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a mask for video without the face</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="va">unmask</span> = <span class="dt">video.frei0r.invert0r</span>(mask)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the pixellized face over the video</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">video.frei0r.addition</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">video.frei0r.multiply</span>(mask, censored),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">video.frei0r.multiply</span>(unmask, cam))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># We have to bufferize the source</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">buffer</span>(<span class="va">buffer</span>=<span class="fl">0.1</span>,<span class="dt">mksafe</span>(s))</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Input audio from microphone</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="va">mic</span> = <span class="dt">input.pulseaudio</span>()</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose sound to generate a funny voice</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="va">mic</span> = <span class="dt">soundtouch</span>(<span class="va">pitch</span>=<span class="fl">1.5</span>, <span class="dt">buffer</span>(mic))</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add sound to video</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">source.mux.audio</span>(<span class="va">audio</span>=mic, s)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s hear the sound</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="dt">output.pulseaudio</span>(<span class="va">fallible</span>=<span class="dv">true</span>, s)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s see the video</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="dt">output.sdl</span>(<span class="va">fallible</span>=<span class="dv">true</span>, s)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">mksafe</span>(s)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the video/sound into a file in theora/vorbis format</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="dt">output.file</span>(<span class="ot">%ogg</span>(<span class="ot">%theora</span>(<span class="va">quality</span>=<span class="dv">63</span>),<span class="ot">%vorbis</span>), <span class="st">&quot;anonymous.ogv&quot;</span>, s)</span></code></pre></div>
<h3 id="controlling-with-osc"><a href="#controlling-with-osc"
class="anchor">Controlling with OSC</a></h3>
<p>In this example we are going to use OSC integration in order to
modify the parameters in realtime. There are many OSC clients around,
for instance I used <a
href="http://hexler.net/software/touchosc">TouchOSC</a> :</p>
<center>
<iframe width="560" height="315" src="//www.youtube.com/embed/EX1PTjiuuXY" frameborder="0" allowfullscreen>
</iframe>
</center>
<p>Here is how the video was made:</p>
<div class="sourceCode" id="cb12" content="video-osc.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"></code></pre></div>
<h3 id="blue-screen"><a href="#blue-screen" class="anchor">Blue
screen</a></h3>
<p>You want to show yourself in front of a video of a bunny, as in</p>
<center>
<iframe width="640" height="360" src="//www.youtube.com/embed/zHikXRNMQu4?feature=player_detailpage" frameborder="0" allowfullscreen>
</iframe>
</center>
<p>The idea is to film yourself in front of a blue screen, make this
blue screen transparent and put the resulting video in front of the
bunny video (actually, I don’t have a blue screen at home, only a white
wall but it still kinda works).</p>
<div class="sourceCode" id="cb13"
data-include="video-bluescreen.liq"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The video of the bunny</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">single</span>(<span class="st">&quot;big_buck_bunny_720p_stereo.ogg&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Input from the webcam</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="va">cam</span> = <span class="dt">input.v4l2</span>()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Flip the video around a vertical axis so that it is easier to position</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># yourself</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="va">cam</span> = <span class="dt">video.frei0r.flippo</span>(<span class="va">x_axis</span>=<span class="dv">true</span>, cam)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the white background transparent I had to tweak the precision parameter</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># so that I will be seen but not the wall</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="va">cam</span> = <span class="dt">video.alpha.of_color</span>(<span class="va">color</span>=<span class="bn">0xffffff</span>, <span class="va">precision</span>=<span class="fl">0.64</span>, cam)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Superpose the two videos</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">add</span>([s,cam])</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Output to SDL</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="dt">output.sdl</span>(<span class="va">fallible</span>=<span class="dv">true</span>, s)</span></code></pre></div>
          <div id="footer"></div>
        </main>
      </div>
    </div>
    <!--   Core JS Files   -->

    <script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/assets/js/liq-jquery.js" type="text/javascript"></script>
  </body>

</html>
