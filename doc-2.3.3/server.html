<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Liquidsoap</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!-- Extra details for Live View on GitHub Pages -->
    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.liquidsoap.info/" />
    <!--  Social tags      -->
    <meta name="keywords" content="radio, audio, video, streaming, icecast, shoutcast">
    <meta name="description" content="Swiss-army knife for multimedia streaming">
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Liquidsoap Streaming Language">
    <meta itemprop="description" content="Swiss-army knife for multimedia streaming">
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@LiquidsoapMedia">
    <meta name="twitter:title" content="Liquidsoap Streaming Language">
    <meta name="twitter:description" content="Swiss-army knife for multimedia streaming">
    <meta name="twitter:creator" content="@LiquidsoapMedia">
    <meta name="twitter:image" content="https://www.liquidsoap.info//assets/img/bottle_invert.png">
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- CSS Files -->
    <link href="/assets/css/custom.css" rel="stylesheet" />
    <link href="/assets/css/material-kit.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <!-- Documentation extras -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="/assets/demo/docs.min.css">
    <style>
    .navbar-absolute-logo {
      padding-left: 45px;
    }

    .navbar-absolute-logo img {
      position: absolute;
      left: 15px;
      margin-top: -6px;
    }

    body {
      background: white;
    }

    p {
        font-size: 16px;
        text-align: justify;
    }
    </style>
    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  </head>

  <body class="bd-docs" data-spy="scroll" data-target=".bd-sidenav-active">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <header class="navbar navbar-expand navbar-dark bg-primary flex-column flex-md-row bd-navbar">
      <a class="navbar-brand mr-0 mr-md-2 navbar-absolute-logo" href="/doc-2.3.3">
        <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 600 600" focusable="false" style="width: 25px; height: 25px;">
          <title>Liquidsoap</title>
          <style type="text/css">
.st0{fill:#FFFFFF;}
          </style>
          <g>
          <path class="st0" d="M102.4,593.8c-0.7-2.8-3.4-2.5-5.3-3.3c-24.6-10.2-37.2-28.7-37.2-55.6c-0.1-72.1,0-144.2,0-216.3
          c0-52.3,0-104.6,0-156.9c0-37.6,23.1-60.9,60.6-61.1c12-0.1,23.9-0.2,35.9,0c15.7,0.3,26.7,10.1,26.3,23
          c-0.4,12.5-11.1,21.5-26.3,21.8c-12,0.2-23.9-0.1-35.9,0.1c-11.8,0.1-15.6,3.7-15.6,15.3c-0.1,124.4,0,248.8-0.1,373.2
          c0,10.3,4.5,15.1,14.8,15.1c69.1-0.1,138.2,0,207.3-0.1c12.3,0,15.5-3.7,15.5-17.7c0-74.7,0-149.4,0-224.2c0-47.8,0-95.6,0-143.5
          c0-15.2-3-18.1-18.4-18.2c-10.8,0-21.7,0.1-32.5,0c-16-0.2-26.7-9.4-26.6-22.5c0.1-13,10.9-22.1,26.9-22.3
          c13.4-0.2,26.9-0.3,40.3,0.1c30.8,1,54.9,24.5,55,55.2c0.3,127.4,0.3,254.8,0.1,382.2c0,25.5-15.8,45.7-40.2,53.3
          c-1.7,0.5-3.8,0-4.5,2.4C262.3,593.8,182.4,593.8,102.4,593.8z"/>
          <path class="st0" d="M537.4,212.6c-16.8,23-56.5,16.5-68.6-9.5c-8-17.2-12.4-32.7-12-54.5c4.6,4.1,8.3,7.5,12.1,10.7
          c10.3,8.6,21,14,35.5,11.8c12.5-1.9,21.5,6,28.2,16.3c2,3,1.3,7.3,4.8,9.5C537.4,202.2,537.4,207.4,537.4,212.6z"/>
          <path class="st0" d="M200.6,230.4c0-55.3,0-110.5,0-165.8c0-40.7,22.3-62.7,63.2-62.7c50.4,0,100.8,0,151.3,0
          c36.1,0,59.1,21.9,60.4,57.7c0.5,13.1,0.4,26.1,0,39.2c-0.4,15.1-10.1,25.8-22.5,25.7c-12-0.1-21.6-10.1-22.3-24.8
          c-0.6-12.7-0.4-25.4-0.1-38.1c0.2-10.4-4.5-14.9-14.9-14.9c-51.5,0.1-103.1,0-154.6,0.1c-12.7,0-15.5,3.2-15.5,17.5
          c0,105.3,0,210.6,0,316c0,7.8,0.1,15.7,0,23.5c-0.2,17.5-9.4,28.9-23,28.6c-13.5-0.3-21.9-10.9-21.9-28.3
          C200.6,346.2,200.6,288.3,200.6,230.4z"/>
          </g>
        </svg>
        Liquidsoap
      </a>
      <ul class="navbar-nav flex-row d-none d-md-flex">
        <li class="nav-item dropdown">
          <a data-versions="dev 2.1.4 2.2.5 2.3.0 2.3.1 2.3.2
2.3.3" data-version="2.3.3" class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="liq-version" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            2.3.3
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="liq-version" id="liq-versions">
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/savonet/liquidsoap" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false">
              <title>GitHub</title>
              <path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd" />
            </svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://twitter.com/liquidsoapmedia" target="_blank" rel="noopener" aria-label="Twitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false">
              <title>Twitter</title>
              <path d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92" fill="currentColor" />
            </svg>
          </a>
        </li>
      </ul>
      <div class="navbar-nav-scroll ml-md-auto ">
        <ul class="navbar-nav bd-navbar-nav flex-row">
          <!--
            <li class="nav-item">
            <a class="nav-link" href=""> <i class="material-icons">card_membership</i> PRO Services </a>
            </li>
            -->
          <li class="nav-item">
            <script async src="https://cse.google.com/cse.js?cx=24f50f6f088994c53"></script>
            <style>
.cse .gsc-control-cse, .gsc-control-cse {
  background-color: transparent;
  border: none;
  width: 300px;
}
            </style>
            <div class="gcse-search"></div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/savonet/liquidsoap/issues" target="_blank" rel="noopener"><i class="material-icons">star</i> Get Help</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="" target="_blank" rel="noopener"></a>
          </li>
        </ul>
      </div>
      <a href="https://github.com/savonet/liquidsoap" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#9c27b0; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
      </a>
      <style>
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out
}

        @keyframes octocat-wave {
          0%,
          100% {
            transform: rotate(0)
          }
          20%,
          60% {
            transform: rotate(-25deg)
          }
          40%,
          80% {
            transform: rotate(10deg)
          }
        }

        @media (max-width:500px) {
          .github-corner:hover .octo-arm {
            animation: none
          }
          .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out
          }
        }
      </style>
    </header>
    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
          <nav class="collapse bd-links" id="bd-docs-nav">
            <div class="bd-toc-item active">
              <ul class="nav bd-sidenav">
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/doc-2.3.3/install.html">
                    Install
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.3/migrating.html">
                    Migrating from previous versions
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="#">
                    Starters
                  </a>
                </li>
                <li><a href="/doc-2.3.3/book.html">The book</a></li>
                <li>
                  <a href="/doc-2.3.3/presentations.html">Video Presentations</a>
                </li>
                <li>
                  <a href="/doc-2.3.3/help.html">How to find help</a>
                </li>
                <li>
                  <a href="/doc-2.3.3/faq.html">Frequently Asked Questions</a>
                </li>
                <li><a href="/doc-2.3.3/quick_start.html">Quickstart</a></li>
                <li>
                  <a href="/doc-2.3.3/complete_case.html">Complete case analysis</a>
                </li>
                <li>
                  <a href="/doc-2.3.3/cookbook.html">Cookbook</a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Reference
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.3/language.html">Script language</a></li>
                <li>
                  <a href="/doc-2.3.3/reference.html">Core API</a></li>
                <li>
                  <a href="/doc-2.3.3/reference-extras.html">Extra API</a></li>
                <li>
                  <a href="/doc-2.3.3/reference-deprecated.html">Deprecated API</a></li>
                <li>
                  <a href="/doc-2.3.3/multitrack.html">Multitrack</a></li>
                <li>
                  <a href="/doc-2.3.3/threads.html">Threads</a></li>
                <li>
                  <a href="/doc-2.3.3/protocols.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.3.3/settings.html">Settings</a></li>
                <li>
                  <a href="/doc-2.3.3/ffmpeg.html">FFmpeg support</a></li>
                <li>
                  <a href="/doc-2.3.3/encoding_formats.html">Encoding formats</a></li>
                <li>
                  <a href="/doc-2.3.3/video.html">Videos streams</a></li>
                <li>
                  <a href="/doc-2.3.3/memory.html">Memory management</a></li>
                <li>
                  <a href="/doc-2.3.3/json.html">JSON import/export</a></li>
                <li>
                  <a href="/doc-2.3.3/xml.html">XML import/export</a></li>
                <li>
                  <a href="/doc-2.3.3/yaml.html">YAML import/export</a></li>
                <li>
                  <a href="/doc-2.3.3/ladspa.html">LADSPA plugins</a></li>
                <li>
                  <a href="/doc-2.3.3/playlist_parsers.html">Playlist parsers</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Core
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.3/sources.html">Sources</a></li>
                <li>
                  <a href="/doc-2.3.3/clocks.html">Clocks</a></li>
                <li>
                  <a href="/doc-2.3.3/requests.html">Requests</a></li>
                <li>
                  <a href="/doc-2.3.3/protocols-presentation.html">Protocols</a></li>
                <li>
                  <a href="/doc-2.3.3/stream_content.html">Stream contents</a></li>
                <li>
                  <a href="/doc-2.3.3/strings_encoding.html">Strings encoding</a></li>
                <li>
                  <a href="/doc-2.3.3/script_loading.html">Script loading</a></li>
                <li><a href="/doc-2.3.3/phases.html">Execution phases</a></li>
              </ul>
            </div>
            <div class="bd-toc-item active">
              <a class="bd-toc-link" href="#">
                Specific tutorials
              </a>
              <ul class="nav bd-sidenav">
                <li>
                  <a href="/doc-2.3.3/harbor_http.html">Using the HTTP server</a></li>
                <li>
                  <a href="/doc-2.3.3/blank.html">Blank detection</a></li>
                <li>
                  <a href="/doc-2.3.3/metadata.html">Customize metadata</a></li>
                <li>
                  <a href="/doc-2.3.3/seek.html">Seek and cue support</a></li>
                <li>
                  <a href="/doc-2.3.3/external_decoders.html">External decoders</a></li>
                <li>
                  <a href="/doc-2.3.3/external_streams.html">External streams</a></li>
                <li>
                  <a href="/doc-2.3.3/external_encoders.html">External encoders</a></li>
                <li>
                  <a href="/doc-2.3.3/hls_output.html">HLS output</a></li>
                <li>
                  <a href="/doc-2.3.3/http_input.html">HTTP input</a></li>
                <li>
                  <a href="/doc-2.3.3/harbor.html">Harbor input</a></li>
                <li>
                  <a href="/doc-2.3.3/stereotool.html">Stereotool</a></li>
                <li>
                  <a href="/doc-2.3.3/server.html">Using the telnet server</a></li>
                <li>
                  <a href="/doc-2.3.3/icy_metadata.html">ICY metadata update</a></li>
                <li>
                  <a href="/doc-2.3.3/replay_gain.html">Normalization and replay gain</a></li>
                <li>
                  <a href="/doc-2.3.3/request_sources.html">Requests-based sources</a></li>
                <li>
                  <a href="/doc-2.3.3/shoutcast.html">Shoutcast output</a></li>
                <li>
                  <a href="/doc-2.3.3/dynamic_sources.html">Dynamic source creation</a></li>
                <li>
                  <a href="/doc-2.3.3/crossfade.html">Crossfading</a></li>
                <li>
                  <a href="/doc-2.3.3/in_production.html">Using in production</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    User scripts
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.3/beets.html">Beets</a></li>
                <li>
                  <a href="/doc-2.3.3/geekradio.html">Geekradio</a></li>
                <li>
                  <a href="/doc-2.3.3/radiopi.html">RadioPi</a></li>
                <li>
                  <a href="/doc-2.3.3/dolebrai.html">Dolebraï</a></li>
                <li>
                  <a href="/doc-2.3.3/frequence3.html">Frequence3</a></li>
                <li>
                  <a href="/doc-2.3.3/video-static.html">Video with a single static image</a></li>
                <li>
                  <a href="/doc-2.3.3/split-cue.html">Split a CUE sheet</a></li>
              </ul>
              <ul class="nav bd-sidenav">
                <li>
                  <a class="bd-toc-link" href="#">
                    Behind the curtains
                  </a>
                </li>
                <li>
                  <a href="/doc-2.3.3/publications.html">Some presentations and publications</a></li>
                <li>
                  <a href="https://github.com/savonet">OCaml libraries</a></li>
                <li class="active bd-sidenav-active">
                  <a class="bd-toc-link" href="/legacy">
                    Legacy website
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
        <!--
          <div class="d-none d-xl-block col-xl-2 bd-toc">
          <ul class="section-nav">
          <li class="toc-entry toc-h2">
          <a href="#quick-start">Quick start</a>
          <ul>
          <li class="toc-entry toc-h3">
          <a href="#css">CSS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#js">JS</a>
          </li>
          <li class="toc-entry toc-h3">
          <a href="#fonts-and-icons">Fonts and Icons</a>
          </li>
          </ul>
          </li>
          <li class="toc-entry toc-h2">
          <a href="#starter-template">Starter template</a>
          </li>
          </ul>
          </div>
        -->
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
          <h1 id="interaction-with-the-server"><a
href="#interaction-with-the-server" class="anchor">Interaction with the
server</a></h1>
<p>Liquidsoap starts with one or several scripts as its configuration,
and then streams forever if everything goes well. Once started, you can
still interact with it by means of the <em>server</em>. The server
allows you to run commands. Some are general and always available, some
belong to a specific operator. For example the
<code>request.queue()</code> instances register commands to enqueue new
requests, the outputs register commands to start or stop the outputting,
display the last ten metadata chunks, etc.</p>
<p>The protocol of the server is a simple human-readable one. Currently
it does not have any kind of authentication and permissions. It is
currently available via two media: TCP and Unix sockets. The TCP socket
provides a simple telnet-like interface, available only on the local
host by default. The Unix socket interface (<em>cf.</em> the
<code>server.socket</code> setting) is through some sort of virtual
file. This is more constraining, which allows one to restrict the use of
the socket to some privileged users.</p>
<p>You can find more details on how to configure the server in the <a
href="help.html#settings">documentation</a> of the settings key
<code>server</code>, in particular <code>server.telnet</code> for the
TCP interface and <code>server.socket</code> for the Unix interface.
Liquidsoap also embeds some <a href="help.html#server">documentation</a>
about the available server commands.</p>
<h3 id="using-telnet"><a href="#using-telnet" class="anchor">Using
telnet</a></h3>
<p>Now, we shall simply enable the Telnet interface to the server, by
setting <code>settings.server.telnet := true</code> or simply passing
the <code>-t</code> option on the command-line. In a <a
href="complete_case.html">complete case analysis</a> we set up a
<code>request.queue()</code> instance to play user requests. It had the
identifier <code>"queue"</code>. We are now going to interact via the
server to push requests into that queue:</p>
<pre><code>dbaelde@selassie:~$ telnet localhost 1234
Trying 127.0.0.1...
Connected to localhost.localdomain.
Escape character is &#39;^]&#39;.
queue.push /path/to/some/file.ogg
5
END
request.metadata 5
[...]
END
queue.push http://remote/audio.ogg
6
END
request.trace 6
[...see if the download started/succeeded...]
END
exit</code></pre>
<p>Of course, the server isn’t very user-friendly. But it is easy to
write scripts to interact with Liquidsoap in that way, to implement a
website or an IRC interface to your radio. However, this sort of tool is
often bound to a specific usage, so we have not released any of
ours.</p>
<h3 id="web-interface"><a href="#web-interface" class="anchor">Web
interface</a></h3>
<p>Another simple way to test the telnet server consists in using
the</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">server.harbor</span>()</span></code></pre></div>
<p>server.harbor api:
https://www.liquidsoap.info/doc-2.0.0/reference-extras.html#server.harbor</p>
<p>command which will start a web interface accessible at <a
href="http://localhost:8000/telnet"
class="uri">http://localhost:8000/telnet</a> providing an emulation of a
telnet.</p>
<h2 id="interactive-variables"><a href="#interactive-variables"
class="anchor">Interactive variables</a></h2>
<p>Sometimes it is useful to control a variable using telnet. A simple
way to achieve this is to use the <code>interactive.float</code>
function. For instance, in order to dynamically the volume of a
source:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Register a telnet variable named volume with 1 as initial value</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="va">v</span> = <span class="dt">interactive.float</span>(<span class="st">&quot;volume&quot;</span>, <span class="fl">1.</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the volume accordingly</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="va">source</span> = <span class="dt">amplify</span>(v, source)</span></code></pre></div>
<p>The first line registers the variable volume on the telnet. Its value
can be changed using the telnet command</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>var.set <span class="va">volume</span> = <span class="fl">0.5</span></span></code></pre></div>
<p>and it can be retrieved using</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>var.get volume</span></code></pre></div>
<p>Similarly, we can switch between two tracks using
<code>interactive.bool</code> and <code>switch</code> as follows:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Activate the telnet server</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>settings.server.telnet := <span class="dv">true</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The two sources</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="va">s1</span> = <span class="dt">playlist</span>(<span class="st">&quot;~/Music&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="va">s2</span> = <span class="dt">sine</span>()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive boolean</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="va">b</span> = <span class="dt">interactive.bool</span>(<span class="st">&quot;button&quot;</span>, <span class="dv">true</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Switch between the tracks depending on the boolean</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="va">s</span> = <span class="dt">switch</span>(<span class="va">track_sensitive</span>=<span class="dv">false</span>,[(b,s1), ({<span class="dv">true</span>},s2)])</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the result</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="dt">output.pulseaudio</span>(s)</span></code></pre></div>
<p>By default the source s1 is played. To switch to s2, you can connect
on the telnet server and type <code>var.set button = false</code>.</p>
<h3 id="web-interface-1"><a href="#web-interface-1" class="anchor">Web
interface</a></h3>
<p>A nice web interface can be obtained by running</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dt">interactive.harbor</span>()</span></code></pre></div>
<p>interactive.harbor api:
https://www.liquidsoap.info/doc-2.0.0/reference.html#interactive.harbor</p>
<p>after all interactive variables have been defined. This will start a
web server accessible at <a href="http://localhost:8000/interactive"
class="uri">http://localhost:8000/interactive</a> on which you can
easily change the values for the interactive variables.</p>
<h3 id="persistency"><a href="#persistency"
class="anchor">Persistency</a></h3>
<p>By default, interactive variables are not <em>persistent</em>, which
means that their values are lost if you restart the script. This can be
changed by running the command</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dt">interactive.persistent</span>(<span class="st">&quot;vars.json&quot;</span>)</span></code></pre></div>
<p>after all the interactive variables have been defined. This will
store the values of all the interactive variables in the file
<code>vars.json</code> (in JSON format) whenever you modify them, and
reload them next time your run your script. This can be very handy for
setting parameters for sound effects for instance.</p>
<h2 id="securing-the-server"><a href="#securing-the-server"
class="anchor">Securing the server</a></h2>
<p>The command server provided by liquidsoap is very convenient for
manipulating a running instance of Liquidsoap. However, no
authentication mechanism is provided. The telnet server has no
authentication and listens by default on the localhost
(<code>127.0.0.1</code>) network interface, which means that it is
accessible to any logged user on the machine.</p>
<p>Many users have expressed interest into setting up a secured access
to the command server, using for instance user and password information.
While we understand and share this need, we do not believe this is a
task that lies into Liquidsoap’s scope. An authentication mechanism is
not something that should be implemented naively. Being SSH, HTTP login
or any other mechanism, all these methods have been, at some point,
exposed to security issues. Thus, implementing our own secure access
would require a constant care about possible security issues.</p>
<p>Rather than doing our own home-made secure access, we believe that
our users should be able to define their own secure access to the
command server, taking advantage of a mainstream authentication
mechanism, for instance HTTP or SSH login. In order to give an example
of this approach, we show here how to create a SSH access to the command
server: we create a SSH user that, when logging through SSH, has only
access to the command server.</p>
<p>First, we enable the unix socket for the command server in
Liquidsoap:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>settings.server.socket := <span class="dv">true</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>settings.server.socket.path := <span class="st">&quot;/path/to/socket&quot;</span></span></code></pre></div>
<p>When started, liquidsoap will create a socket file
<code>/path/to/socket</code> that can be used to interact with the
command server. For instance, if your user has read and write rights on
the socket file, you can do</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode liquidsoap"><code class="sourceCode liquidsoap"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>socat /path/to/socket -</span></code></pre></div>
<p>The interface is then exactly the same has for the telnet server.</p>
<p>We define now a new
`<code>shell''. This shell is in fact the invocation of the socat command. Thus, we create a</code>/usr/local/bin/liq_shell`
file with the following content:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We test if the file is a socket, readable and writable.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-S</span> /path/to/socket <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">[</span> <span class="ot">-w</span> /path/to/socket <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="dt">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>   <span class="bu">[</span> <span class="ot">-r</span> /path/to/socket <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="ex">socat</span> /path/to/socket <span class="at">-</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># If not, we exit..</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="bu">exit</span> 1</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
<p>We set this file as executable, and we add it in the list of shells
in <code>/etc/shells</code>.</p>
<p>Now, we create a user with the <code>liq_shell</code> as its
shell:</p>
<pre><code>adduser --shell /usr/local/bin/liq_shell liq-user</code></pre>
<p>You also need to make sure that <code>liq-user</code> has read and
write rights on the socket file.</p>
<p>Finally, when logging through ssh with <code>liq-user</code>, we
get:</p>
<pre><code>11:27 toots@leonard % ssh liq-user@localhost
liq-user@localhost&#39;s password:
Linux leonard 2.6.32-4-amd64 #1 SMP Mon Apr 5 21:14:10 UTC 2010 x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Oct  5 11:26:52 2010 from localhost
help
Available commands:
(...)
| exit
| help [&lt;command&gt;]
| list
| quit
| request.alive
| request.all
| request.metadata &lt;rid&gt;
| request.on_air
| request.resolving
| request.trace &lt;rid&gt;
| uptime
| var.get &lt;variable&gt;
| var.list
| var.set &lt;variable&gt; = &lt;value&gt;
| version

Type &quot;help &lt;command&gt;&quot; for more information.
END
exit
Bye!
END
Connection to localhost closed.</code></pre>
<p>This is an example of how you can use an existing secure access to
secure the access to liquidsoap’s command server. This way, you make
sure that you are using a mainstream secure application, here SSH.</p>
<p>This example may be adapted similarly to use an online HTTP login
mechanism, which is probably the most comment type of mechanism intended
for the command line server.</p>
          <div id="footer"></div>
        </main>
      </div>
    </div>
    <!--   Core JS Files   -->

    <script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/assets/js/liq-jquery.js" type="text/javascript"></script>
  </body>

</html>
